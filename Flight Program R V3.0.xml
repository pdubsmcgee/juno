<?xml version="1.0" encoding="utf-8"?>
<Program name="Flight Program R V3.0">
  <Variables>
    <Variable name="targetalt_m" number="0" />
    <Variable name="targetinc_deg" number="0" />
    <Variable name="fc_mode" number="0" />
    <Variable name="attowner" number="0" />
    <Variable name="throwner" number="0" />
    <Variable name="fc_mode_none" number="0" />
    <Variable name="fc_mode_countdown" number="0" />
    <Variable name="fc_mode_ascent" number="0" />
    <Variable name="fc_mode_circularization" number="0" />
    <Variable name="fc_mode_done" number="0" />
    <Variable name="attowner_none" number="0" />
    <Variable name="attowner_gravity_turn" number="0" />
    <Variable name="attowner_guidance" number="0" />
    <Variable name="attowner_circularization" number="0" />
    <Variable name="throwner_none" number="0" />
    <Variable name="throwner_gravity_turn" number="0" />
    <Variable name="throwner_guidance" number="0" />
    <Variable name="throwner_circularization" number="0" />
    <Variable name="manual" number="0" />
    <Variable name="fc_init_done" number="0" />
    <Variable name="fc_status_code" number="0" />
    <Variable name="fc_fault_code" number="0" />
    <Variable name="countdown_timeout_s" number="0" />
    <Variable name="countdown_elapsed_s" number="0" />
    <Variable name="countdown_abort" number="0" />
    <Variable name="countdown_arm_throttle" number="0" />
    <Variable name="countdown_tick_s" number="0" />
    <Variable name="countdown_timeout_default_s" number="0" />
    <Variable name="ascent_transition_altitude_m" number="0" />
    <Variable name="ascent_guidance_enable_speed_mps" number="0" />
    <Variable name="ascent_apoapsis_buffer_m" number="0" />
    <Variable name="ascent_circ_entry_altitude_ratio" number="0" />
    <Variable name="circularization_gain_divisor" number="0" />
    <Variable name="gt_tsv" number="0" />
    <Variable name="gt_tev" number="0" />
    <Variable name="gt_pitchmin" number="0" />
    <Variable name="gt_maxaoa" number="0" />
    <Variable name="gt_pitchcmd" number="0" />
    <Variable name="gt_headingcmd" number="0" />
    <Variable name="peg_readyk" number="0" />
    <Variable name="peg_e1" number="0" />
    <Variable name="peg_e2" number="0" />
    <Variable name="peg_temp" number="0" />
    <Variable name="peg_k" number="0" />
    <Variable name="peg_r0" number="0" />
    <Variable name="peg_nodeaxis" number="0" />
    <Variable name="peg_htarget" number="0" />
    <Variable name="peg_pitchcmd" number="0" />
    <Variable name="peg_headingcmd" number="0" />
    <Variable name="circ_active" number="0" />
    <Variable name="frac" number="0" />
    <Variable name="mu" number="0" />
    <Variable name="ra" number="0" />
    <Variable name="dv" number="0" />
    <Variable name="burnstart" number="0" />
    <Variable name="lowfuelcount" number="0" />
    <Variable name="lowthrustcount" number="0" />
    <Variable name="stagelock" number="0" />
    <Variable name="init" number="0" />
    <Variable name="smoothdiv" number="0" />
    <Variable name="pitchbase" number="0" />
    <Variable name="vsurf" number="0" />
    <Variable name="denom" number="0" />
    <Variable name="tempmag" number="0" />
    <Variable name="escale" number="0" />
    <Variable name="k_e_max" number="0" />
    <Variable name="k_i_max" number="0" />
    <Variable name="targetinc_rad" number="0" />
    <Variable name="rvec" number="0" />
    <Variable name="vvec" number="0" />
    <Variable name="rhat" number="0" />
    <Variable name="nhat" number="0" />
    <Variable name="ehat" number="0" />
    <Variable name="ki" number="0" />
    <Variable name="peg_htarget_ready" number="0" />
    <Variable name="cosi" number="0" />
    <Variable name="sini" number="0" />
    <Variable name="term1" number="0" />
    <Variable name="term2" number="0" />
    <Variable name="term3" number="0" />
    <Variable name="hvec" number="0" />
    <Variable name="hhat" number="0" />
    <Variable name="planeerroraxis" number="0" />
    <Variable name="planeerrormag" number="0" />
    <Variable name="r" number="0" />
    <Variable name="rt" number="0" />
    <Variable name="vcirc" number="0" />
    <Variable name="gvec" number="0" />
    <Variable name="rmag" number="0" />
    <Variable name="gmag" number="0" />
    <Variable name="vmag" number="0" />
    <Variable name="ee" number="0" />
    <Variable name="ke" number="0" />
    <Variable name="e" number="0" />
    <Variable name="et" number="0" />
    <Variable name="traw" number="0" />
    <Variable name="that" number="0" />
    <Variable name="hvec2" number="0" />
    <Variable name="hhat2" number="0" />
    <Variable name="caxis" number="0" />
    <Variable name="pdir" number="0" />
    <Variable name="ucomp" number="0" />
    <Variable name="ncomp" number="0" />
    <Variable name="ecomp" number="0" />
    <Variable name="pitchrad" number="0" />
    <Variable name="pitchdeg" number="0" />
    <Variable name="headingrad" number="0" />
    <Variable name="headingdeg" number="0" />
    <Variable name="dcmd" number="0" />
    <Variable name="hdgerror" number="0" />
    <Variable name="circ_tolalt" number="0" />
    <Variable name="circ_toldv" number="0" />
    <Variable name="circ_minthrust" number="0" />
    <Variable name="circ_mintime" number="0" />
    <Variable name="vnow" number="0" />
    <Variable name="m" number="0" />
    <Variable name="maxt" number="0" />
    <Variable name="tburn" number="0" />
    <Variable name="thrcut" number="0" />
    <Variable name="twr_target_gt" number="0" />
    <Variable name="twr_target_peg" number="0" />
    <Variable name="minthrottle" number="0" />
    <Variable name="maxthrottle" number="0" />
    <Variable name="thr" number="0" />
    <Variable name="circlocked" number="0" />
  </Variables>
  <Instructions>
    <Event event="FlightStart" id="0" style="flight-start" pos="3913.307,81.01453" />
    <Comment id="1" style="comment">
      <Constant style="comment-text" canReplace="false" text="GT Guidance (frame-synced guidance loop tick)" />
    </Comment>
    <WaitUntil id="2" style="wait-until">
      <Comparison op="=" style="op-eq">
        <Variable list="false" local="false" variableName="fc_init_done" />
        <Constant text="1" />
      </Comparison>
    </WaitUntil>
    <SetVariable id="3" style="set-variable">
      <Variable list="false" local="false" variableName="gt_tsv" />
      <Constant text="250" />
    </SetVariable>
    <SetVariable id="4" style="set-variable">
      <Variable list="false" local="false" variableName="gt_tev" />
      <Constant text="2400" />
    </SetVariable>
    <SetVariable id="5" style="set-variable">
      <Variable list="false" local="false" variableName="gt_pitchmin" />
      <Constant text="15" />
    </SetVariable>
    <SetVariable id="6" style="set-variable">
      <Variable list="false" local="false" variableName="gt_maxaoa" />
      <Constant text="8" />
    </SetVariable>
    <SetVariable id="7" style="set-variable">
      <Variable list="false" local="false" variableName="gt_pitchcmd" />
      <Constant text="90" />
    </SetVariable>
    <SetVariable id="8" style="set-variable">
      <Variable list="false" local="false" variableName="gt_headingcmd" />
      <BinaryOp op="+" style="op-add">
        <Variable list="false" local="false" variableName="targetinc_deg" />
        <Constant text="90" />
      </BinaryOp>
    </SetVariable>
    <While id="9" style="while">
      <Constant style="true" bool="true" />
      <Instructions>
        <If id="10" style="if">
          <Not style="op-not">
            <Comparison op="=" style="op-eq">
              <Variable list="false" local="false" variableName="attowner" />
              <Constant text="1" />
            </Comparison>
          </Not>
          <Instructions />
        </If>
        <ElseIf id="12" style="else">
          <Constant bool="true" />
          <Instructions>
            <SetVariable id="13" style="set-variable">
              <Variable list="false" local="false" variableName="vsurf" />
              <CraftProperty property="Vel.SurfaceVelocity" style="prop-velocity" />
            </SetVariable>
            <SetVariable id="14" style="set-variable">
              <Variable list="false" local="false" variableName="denom" />
              <BinaryOp op="-" style="op-sub">
                <Variable list="false" local="false" variableName="gt_tev" />
                <Variable list="false" local="false" variableName="gt_tsv" />
              </BinaryOp>
            </SetVariable>
            <If id="15" style="if">
              <Comparison op="l" style="op-lt">
                <Variable list="false" local="false" variableName="denom" />
                <Constant text="1" />
              </Comparison>
              <Instructions>
                <SetVariable id="16" style="set-variable">
                  <Variable list="false" local="false" variableName="denom" />
                  <Constant text="1" />
                </SetVariable>
              </Instructions>
            </If>
            <SetVariable id="17" style="set-variable">
              <Variable list="false" local="false" variableName="frac" />
              <BinaryOp op="/" style="op-div">
                <BinaryOp op="-" style="op-sub">
                  <Variable list="false" local="false" variableName="vsurf" />
                  <Variable list="false" local="false" variableName="gt_tsv" />
                </BinaryOp>
                <Variable list="false" local="false" variableName="denom" />
              </BinaryOp>
            </SetVariable>
            <If id="18" style="if">
              <Comparison op="l" style="op-lt">
                <Variable list="false" local="false" variableName="frac" />
                <Constant text="0" />
              </Comparison>
              <Instructions>
                <SetVariable id="19" style="set-variable">
                  <Variable list="false" local="false" variableName="frac" />
                  <Constant text="0" />
                </SetVariable>
              </Instructions>
            </If>
            <If id="20" style="if">
              <Comparison op="l" style="op-lt">
                <Constant text="1" />
                <Variable list="false" local="false" variableName="frac" />
              </Comparison>
              <Instructions>
                <SetVariable id="21" style="set-variable">
                  <Variable list="false" local="false" variableName="frac" />
                  <Constant text="1" />
                </SetVariable>
              </Instructions>
            </If>
            <SetVariable id="22" style="set-variable">
              <Variable list="false" local="false" variableName="pitchbase" />
              <BinaryOp op="-" style="op-sub">
                <Constant text="90" />
                <BinaryOp op="*" style="op-mul">
                  <Constant text="90" />
                  <Variable list="false" local="false" variableName="frac" />
                </BinaryOp>
              </BinaryOp>
            </SetVariable>
            <If id="23" style="if">
              <Comparison op="l" style="op-lt">
                <Variable list="false" local="false" variableName="pitchbase" />
                <Variable list="false" local="false" variableName="gt_pitchmin" />
              </Comparison>
              <Instructions>
                <SetVariable id="24" style="set-variable">
                  <Variable list="false" local="false" variableName="pitchbase" />
                  <Variable list="false" local="false" variableName="gt_pitchmin" />
                </SetVariable>
              </Instructions>
            </If>
            <SetVariable id="28" style="set-variable">
              <Variable list="false" local="false" variableName="smoothdiv" />
              <Constant text="10" />
            </SetVariable>
            <If id="25" style="if">
              <Comparison op="l" style="op-lt">
                <Variable list="false" local="false" variableName="gt_maxaoa" />
                <CraftProperty property="Nav.AngleOfAttack" style="prop-nav" />
              </Comparison>
              <Instructions>
                <SetVariable id="26" style="set-variable">
                  <Variable list="false" local="false" variableName="smoothdiv" />
                  <Constant text="20" />
                </SetVariable>
              </Instructions>
            </If>
            <SetVariable id="29" style="set-variable">
              <Variable list="false" local="false" variableName="gt_pitchcmd" />
              <BinaryOp op="+" style="op-add">
                <Variable list="false" local="false" variableName="gt_pitchcmd" />
                <BinaryOp op="/" style="op-div">
                  <BinaryOp op="-" style="op-sub">
                    <Variable list="false" local="false" variableName="pitchbase" />
                    <Variable list="false" local="false" variableName="gt_pitchcmd" />
                  </BinaryOp>
                  <Variable list="false" local="false" variableName="smoothdiv" />
                </BinaryOp>
              </BinaryOp>
            </SetVariable>
            <SetTargetHeading property="heading" id="30" style="set-heading">
              <Variable list="false" local="false" variableName="gt_headingcmd" />
            </SetTargetHeading>
            <SetTargetHeading property="pitch" id="31" style="set-heading">
              <Variable list="false" local="false" variableName="gt_pitchcmd" />
            </SetTargetHeading>
          </Instructions>
        </ElseIf>
        <WaitSeconds id="33" style="wait-seconds">
          <Constant text="0.05" />
        </WaitSeconds>
      </Instructions>
    </While>
  </Instructions>
  <Instructions>
    <Comment id="34" style="comment" pos="3495.952,976.8877">
      <Constant style="comment-text" canReplace="false" text="Peg Guidance" />
    </Comment>
  </Instructions>
  <Instructions>
    <Event event="FlightStart" id="35" style="flight-start" pos="2440.463,1133.957" />
    <Comment id="36" style="comment">
      <Constant style="comment-text" canReplace="false" text="K solver" />
    </Comment>
    <WaitUntil id="37" style="wait-until">
      <Comparison op="=" style="op-eq">
        <Variable list="false" local="false" variableName="fc_init_done" />
        <Constant text="1" />
      </Comparison>
    </WaitUntil>
    <SetVariable id="38" style="set-variable">
      <Variable list="false" local="false" variableName="peg_readyk" />
      <Constant number="0" />
    </SetVariable>
    <SetVariable id="39" style="set-variable">
      <Variable list="false" local="false" variableName="peg_e1" />
      <VectorOp op="norm" style="vec-op-1">
        <CraftProperty property="Nav.East" style="prop-nav" />
      </VectorOp>
    </SetVariable>
    <While id="40" style="while">
      <Constant style="true" bool="true" />
      <Instructions>
        <If id="41" style="if">
          <Comparison op="=" style="op-eq">
            <Variable list="false" local="false" variableName="peg_readyk" />
            <Constant text="1" />
          </Comparison>
          <Instructions>
            <WaitSeconds id="42" style="wait-seconds">
              <Constant text="10" />
            </WaitSeconds>
          </Instructions>
        </If>
        <ElseIf id="3622" style="else">
          <Constant bool="true" />
          <Instructions>
            <WaitSeconds id="43" style="wait-seconds">
              <Constant text="10" />
            </WaitSeconds>
            <SetVariable id="44" style="set-variable">
              <Variable list="false" local="false" variableName="peg_e2" />
              <VectorOp op="norm" style="vec-op-1">
                <CraftProperty property="Nav.East" style="prop-nav" />
              </VectorOp>
            </SetVariable>
            <SetVariable id="45" style="set-variable">
              <Variable list="false" local="false" variableName="peg_temp" />
              <VectorOp op="cross" style="vec-op-2">
                <Variable list="false" local="false" variableName="peg_e1" />
                <Variable list="false" local="false" variableName="peg_e2" />
              </VectorOp>
            </SetVariable>
            <SetVariable id="46" style="set-variable">
              <Variable list="false" local="false" variableName="tempmag" />
              <VectorOp op="length" style="vec-op-1">
                <Variable list="false" local="false" variableName="peg_temp" />
              </VectorOp>
            </SetVariable>
            <If id="47" style="if">
              <Comparison op="g" style="op-gt">
                <Variable list="false" local="false" variableName="tempmag" />
                <Constant text=".0001" />
              </Comparison>
              <Instructions>
                <SetVariable id="48" style="set-variable">
                  <Variable list="false" local="false" variableName="peg_k" />
                  <VectorOp op="norm" style="vec-op-1">
                    <Variable list="false" local="false" variableName="peg_temp" />
                  </VectorOp>
                </SetVariable>
                <SetVariable id="49" style="set-variable">
                  <Variable list="false" local="false" variableName="peg_readyk" />
                  <Constant text="1" />
                </SetVariable>
                <LogFlight id="50" style="flightlog">
                  <Constant text="K value solved" />
                  <Constant style="false" bool="false" />
                </LogFlight>
              </Instructions>
            </If>
            <ElseIf id="51" style="else">
              <Constant bool="true" />
              <Instructions>
                <SetVariable id="52" style="set-variable">
                  <Variable list="false" local="false" variableName="peg_e1" />
                  <Variable list="false" local="false" variableName="peg_e2" />
                </SetVariable>
              </Instructions>
            </ElseIf>
          </Instructions>
        </ElseIf>
      </Instructions>
    </While>
  </Instructions>
  <Instructions>
    <Event event="FlightStart" id="53" style="flight-start" pos="2067.532,-94.64899" />
    <Comment id="54" style="comment">
      <Constant style="comment-text" canReplace="false" text="Flight Mode Controller (mode/status loop tick: 0.05s)" />
    </Comment>
    <Comment id="55" style="comment">
      <Constant style="comment-text" canReplace="false" text="fc_mode states: none=0, countdown=1, ascent=2, circularization=3, done=4" />
    </Comment>
    <Comment id="56" style="comment">
      <Constant style="comment-text" canReplace="false" text="attowner states: none/manual=0, gravity_turn=1, guidance=2, circularization=3" />
    </Comment>
    <Comment id="57" style="comment">
      <Constant style="comment-text" canReplace="false" text="throwner states: none/manual=0, gravity_turn=1, guidance=2, circularization=3" />
    </Comment>
    <SetVariable id="58" style="set-variable">
      <Variable list="false" local="false" variableName="fc_mode_none" />
      <Constant text="0" />
    </SetVariable>
    <SetVariable id="59" style="set-variable">
      <Variable list="false" local="false" variableName="fc_mode_countdown" />
      <Constant text="1" />
    </SetVariable>
    <SetVariable id="60" style="set-variable">
      <Variable list="false" local="false" variableName="fc_mode_ascent" />
      <Constant text="2" />
    </SetVariable>
    <SetVariable id="61" style="set-variable">
      <Variable list="false" local="false" variableName="fc_mode_circularization" />
      <Constant text="3" />
    </SetVariable>
    <SetVariable id="62" style="set-variable">
      <Variable list="false" local="false" variableName="fc_mode_done" />
      <Constant text="4" />
    </SetVariable>
    <SetVariable id="63" style="set-variable">
      <Variable list="false" local="false" variableName="attowner_none" />
      <Constant text="0" />
    </SetVariable>
    <SetVariable id="64" style="set-variable">
      <Variable list="false" local="false" variableName="attowner_gravity_turn" />
      <Constant text="1" />
    </SetVariable>
    <SetVariable id="65" style="set-variable">
      <Variable list="false" local="false" variableName="attowner_guidance" />
      <Constant text="2" />
    </SetVariable>
    <SetVariable id="66" style="set-variable">
      <Variable list="false" local="false" variableName="attowner_circularization" />
      <Constant text="3" />
    </SetVariable>
    <SetVariable id="67" style="set-variable">
      <Variable list="false" local="false" variableName="throwner_none" />
      <Constant text="0" />
    </SetVariable>
    <SetVariable id="68" style="set-variable">
      <Variable list="false" local="false" variableName="throwner_gravity_turn" />
      <Constant text="1" />
    </SetVariable>
    <SetVariable id="69" style="set-variable">
      <Variable list="false" local="false" variableName="throwner_guidance" />
      <Constant text="2" />
    </SetVariable>
    <SetVariable id="70" style="set-variable">
      <Variable list="false" local="false" variableName="throwner_circularization" />
      <Constant text="3" />
    </SetVariable>
    <SetVariable id="473" style="set-variable">
      <Variable list="false" local="false" variableName="ascent_transition_altitude_m" />
      <Constant text="10000" />
    </SetVariable>
    <SetVariable id="474" style="set-variable">
      <Variable list="false" local="false" variableName="ascent_guidance_enable_speed_mps" />
      <Constant text="600" />
    </SetVariable>
    <SetVariable id="475" style="set-variable">
      <Variable list="false" local="false" variableName="ascent_apoapsis_buffer_m" />
      <Constant text="1000" />
    </SetVariable>
    <SetVariable id="476" style="set-variable">
      <Variable list="false" local="false" variableName="ascent_circ_entry_altitude_ratio" />
      <Constant text="0.7" />
    </SetVariable>
    <SetVariable id="477" style="set-variable">
      <Variable list="false" local="false" variableName="circularization_gain_divisor" />
      <Constant text="50" />
    </SetVariable>
    <SetVariable id="478" style="set-variable">
      <Variable list="false" local="false" variableName="countdown_arm_throttle" />
      <Constant text="0.9" />
    </SetVariable>
    <SetVariable id="479" style="set-variable">
      <Variable list="false" local="false" variableName="countdown_timeout_default_s" />
      <Constant text="30" />
    </SetVariable>
    <SetVariable id="480" style="set-variable">
      <Variable list="false" local="false" variableName="countdown_tick_s" />
      <Constant text="0.1" />
    </SetVariable>
    <SetVariable id="71" style="set-variable">
      <Variable list="false" local="false" variableName="fc_mode" />
      <Variable list="false" local="false" variableName="fc_mode_countdown" />
    </SetVariable>
    <SetVariable id="72" style="set-variable">
      <Variable list="false" local="false" variableName="attowner" />
      <Variable list="false" local="false" variableName="attowner_none" />
    </SetVariable>
    <SetVariable id="73" style="set-variable">
      <Variable list="false" local="false" variableName="throwner" />
      <Variable list="false" local="false" variableName="throwner_none" />
    </SetVariable>
    <SetVariable id="74" style="set-variable">
      <Variable list="false" local="false" variableName="fc_status_code" />
      <Constant text="0" />
    </SetVariable>
    <SetVariable id="75" style="set-variable">
      <Variable list="false" local="false" variableName="fc_fault_code" />
      <Constant text="0" />
    </SetVariable>
    <SetVariable id="76" style="set-variable">
      <Variable list="false" local="false" variableName="fc_init_done" />
      <Constant text="0" />
    </SetVariable>
    <UserInput id="77" style="user-input">
      <Variable list="false" local="false" variableName="targetalt_m" />
      <Constant text="Target altitude (m AGL). Enter 10000 to 500000." />
    </UserInput>
    <UserInput id="78" style="user-input">
      <Variable list="false" local="false" variableName="targetinc_deg" />
      <Constant text="Target inclination (deg). Enter 0 to 180." />
    </UserInput>
    <UserInput id="79" style="user-input">
      <Variable list="false" local="false" variableName="init" />
      <Constant text="Autostage enabled? Enter 1=yes, 0=no." />
    </UserInput>
    <If id="80" style="if">
      <Comparison op="l" style="op-lt">
        <Variable list="false" local="false" variableName="targetalt_m" />
        <Constant text="10000" />
      </Comparison>
      <Instructions>
        <SetVariable id="81" style="set-variable">
          <Variable list="false" local="false" variableName="targetalt_m" />
          <Constant text="10000" />
        </SetVariable>
        <LogFlight id="82" style="flightlog">
          <Constant text="Target altitude below limit; clamped to 10000 m." />
          <Constant style="false" bool="false" />
        </LogFlight>
      </Instructions>
    </If>
    <ElseIf id="83" style="else">
      <Comparison op="g" style="op-gt">
        <Variable list="false" local="false" variableName="targetalt_m" />
        <Constant text="500000" />
      </Comparison>
      <Instructions>
        <SetVariable id="84" style="set-variable">
          <Variable list="false" local="false" variableName="targetalt_m" />
          <Constant text="500000" />
        </SetVariable>
        <LogFlight id="85" style="flightlog">
          <Constant text="Target altitude above limit; clamped to 500000 m." />
          <Constant style="false" bool="false" />
        </LogFlight>
      </Instructions>
    </ElseIf>
    <If id="86" style="if">
      <Comparison op="l" style="op-lt">
        <Variable list="false" local="false" variableName="targetinc_deg" />
        <Constant text="0" />
      </Comparison>
      <Instructions>
        <SetVariable id="87" style="set-variable">
          <Variable list="false" local="false" variableName="targetinc_deg" />
          <Constant text="0" />
        </SetVariable>
        <LogFlight id="88" style="flightlog">
          <Constant text="Target inclination below range; clamped to 0 deg." />
          <Constant style="false" bool="false" />
        </LogFlight>
      </Instructions>
    </If>
    <ElseIf id="89" style="else">
      <Comparison op="g" style="op-gt">
        <Variable list="false" local="false" variableName="targetinc_deg" />
        <Constant text="180" />
      </Comparison>
      <Instructions>
        <SetVariable id="90" style="set-variable">
          <Variable list="false" local="false" variableName="targetinc_deg" />
          <Constant text="180" />
        </SetVariable>
        <LogFlight id="91" style="flightlog">
          <Constant text="Target inclination above range; clamped to 180 deg." />
          <Constant style="false" bool="false" />
        </LogFlight>
      </Instructions>
    </ElseIf>
    <If id="92" style="if">
      <BoolOp op="and" style="op-and">
        <Not style="op-not" pos="2099.416,-1747.983">
          <Comparison op="=" style="op-eq" pos="2148.452,-1749.723">
            <Variable list="false" local="false" variableName="init" />
            <Constant text="1" />
          </Comparison>
        </Not>
        <Not style="op-not" pos="2331.26,-1747.144">
          <Comparison op="=" style="op-eq">
            <Variable list="false" local="false" variableName="init" />
            <Constant text="0" />
          </Comparison>
        </Not>
      </BoolOp>
      <Instructions>
        <LogFlight id="93" style="flightlog">
          <Constant text="Autostage input invalid; normalizing to 0 or 1." />
          <Constant style="false" bool="false" />
        </LogFlight>
        <SetVariable id="94" style="set-variable">
          <Variable list="false" local="false" variableName="init" />
          <Constant text="1" />
        </SetVariable>
      </Instructions>
    </If>
    <If id="95" style="if">
      <Comparison op="=" style="op-eq" pos="2102.12,-1852.406">
        <Variable list="false" local="false" variableName="init" />
        <Constant text="1" />
      </Comparison>
      <Instructions>
        <SetVariable id="96" style="set-variable">
          <Variable list="false" local="false" variableName="init" />
          <Constant text="1" />
        </SetVariable>
      </Instructions>
    </If>
    <ElseIf id="97" style="else">
      <Constant bool="true" />
      <Instructions>
        <SetVariable id="98" style="set-variable">
          <Variable list="false" local="false" variableName="init" />
          <Constant text="0" />
        </SetVariable>
      </Instructions>
    </ElseIf>
    <LogFlight id="99" style="flightlog">
      <Constant text="Preflight normalized inputs: altitude/inclination/autostage configured." />
      <Constant style="false" bool="false" />
    </LogFlight>
    <SetVariable id="100" style="set-variable">
      <Variable list="false" local="false" variableName="fc_init_done" />
      <Constant text="1" />
    </SetVariable>
    <While id="101" style="while">
      <Constant style="true" bool="true" />
      <Instructions>
        <SetVariable id="102" style="set-variable">
          <Variable list="false" local="false" variableName="manual" />
          <ActivationGroup style="activation-group">
            <Constant number="1" />
          </ActivationGroup>
        </SetVariable>
        <If id="103" style="if">
          <Comparison op="=" style="op-eq">
            <Variable list="false" local="false" variableName="manual" />
            <Constant text="1" />
          </Comparison>
          <Instructions>
            <SetVariable id="104" style="set-variable">
              <Variable list="false" local="false" variableName="attowner" />
              <Variable list="false" local="false" variableName="attowner_none" />
            </SetVariable>
            <SetVariable id="105" style="set-variable">
              <Variable list="false" local="false" variableName="throwner" />
              <Variable list="false" local="false" variableName="throwner_none" />
            </SetVariable>
            <SetVariable id="106" style="set-variable">
              <Variable list="false" local="false" variableName="fc_mode" />
              <Variable list="false" local="false" variableName="fc_mode_none" />
            </SetVariable>
            <SetVariable id="1061" style="set-variable">
              <Variable list="false" local="false" variableName="fc_status_code" />
              <Constant text="5" />
            </SetVariable>
            <LogFlight id="1062" style="flightlog">
              <Constant text="Manual takeover active: skipping FC mode dispatch this tick." />
              <Constant style="false" bool="false" />
            </LogFlight>
          </Instructions>
        </If>
        <ElseIf id="1063" style="else">
          <Constant bool="true" />
          <Instructions>
            <If id="107" style="if">
              <Comparison op="=" style="op-eq">
                <Variable list="false" local="false" variableName="fc_mode" />
                <Variable list="false" local="false" variableName="fc_mode_countdown" />
              </Comparison>
              <Instructions>
                <If id="1071" style="if">
                  <Comparison op="=" style="op-eq">
                    <Variable list="false" local="false" variableName="fc_fault_code" />
                    <Constant text="0" />
                  </Comparison>
                  <Instructions>
                    <SetVariable id="108" style="set-variable">
                      <Variable list="false" local="false" variableName="fc_status_code" />
                      <Constant text="10" />
                    </SetVariable>
                    <CallCustomInstruction call="Countdown" id="109" style="call-custom-instruction" />
                  </Instructions>
                </If>
                <ElseIf id="1072" style="else">
                  <Constant bool="true" />
                  <Instructions>
                    <SetVariable id="1073" style="set-variable">
                      <Variable list="false" local="false" variableName="fc_mode" />
                      <Variable list="false" local="false" variableName="fc_mode_none" />
                    </SetVariable>
                    <SetVariable id="1074" style="set-variable">
                      <Variable list="false" local="false" variableName="attowner" />
                      <Variable list="false" local="false" variableName="attowner_none" />
                    </SetVariable>
                    <SetVariable id="1075" style="set-variable">
                      <Variable list="false" local="false" variableName="throwner" />
                      <Variable list="false" local="false" variableName="throwner_none" />
                    </SetVariable>
                    <SetVariable id="1076" style="set-variable">
                      <Variable list="false" local="false" variableName="fc_status_code" />
                      <Constant text="0" />
                    </SetVariable>
                  </Instructions>
                </ElseIf>
              </Instructions>
            </If>
            <ElseIf id="110" style="else">
              <Comparison op="=" style="op-eq">
                <Variable list="false" local="false" variableName="fc_mode" />
                <Variable list="false" local="false" variableName="fc_mode_ascent" />
              </Comparison>
              <Instructions>
                <SetVariable id="111" style="set-variable">
                  <Variable list="false" local="false" variableName="fc_status_code" />
                  <Constant text="20" />
                </SetVariable>
                <If id="112" style="if">
                  <Comparison op="l" style="op-lt">
                    <CraftProperty property="Altitude.AGL" style="prop-altitude" />
                    <Variable list="false" local="false" variableName="ascent_transition_altitude_m" />
                  </Comparison>
                  <Instructions>
                    <SetVariable id="113" style="set-variable">
                      <Variable list="false" local="false" variableName="attowner" />
                      <Variable list="false" local="false" variableName="attowner_gravity_turn" />
                    </SetVariable>
                    <SetVariable id="114" style="set-variable">
                      <Variable list="false" local="false" variableName="throwner" />
                      <Variable list="false" local="false" variableName="throwner_gravity_turn" />
                    </SetVariable>
                  </Instructions>
                </If>
                <ElseIf id="115" style="else">
                  <Constant bool="true" />
                  <Instructions>
                    <If id="116" style="if">
                      <BoolOp op="and" style="op-and">
                        <Comparison op="g" style="op-gt">
                          <CraftProperty property="Vel.SurfaceVelocity" style="prop-velocity" />
                          <Variable list="false" local="false" variableName="ascent_guidance_enable_speed_mps" />
                        </Comparison>
                        <Comparison op="l" style="op-lt">
                          <CraftProperty property="Nav.AngleOfAttack" style="prop-nav" />
                          <Variable list="false" local="false" variableName="gt_maxaoa" />
                        </Comparison>
                      </BoolOp>
                      <Instructions>
                        <SetVariable id="117" style="set-variable">
                          <Variable list="false" local="false" variableName="attowner" />
                          <Variable list="false" local="false" variableName="attowner_guidance" />
                        </SetVariable>
                        <SetVariable id="118" style="set-variable">
                          <Variable list="false" local="false" variableName="throwner" />
                          <Variable list="false" local="false" variableName="throwner_guidance" />
                        </SetVariable>
                      </Instructions>
                    </If>
                    <ElseIf id="119" style="else">
                      <Constant bool="true" />
                      <Instructions>
                        <SetVariable id="120" style="set-variable">
                          <Variable list="false" local="false" variableName="attowner" />
                          <Variable list="false" local="false" variableName="attowner_gravity_turn" />
                        </SetVariable>
                        <SetVariable id="121" style="set-variable">
                          <Variable list="false" local="false" variableName="throwner" />
                          <Variable list="false" local="false" variableName="throwner_gravity_turn" />
                        </SetVariable>
                      </Instructions>
                    </ElseIf>
                  </Instructions>
                </ElseIf>
                <If id="122" style="if">
                  <BoolOp op="and" style="op-and">
                    <Comparison op="ge" style="op-gte">
                      <CraftProperty property="Orbit.Apoapsis" style="prop-orbit" />
                      <BinaryOp op="+" style="op-add">
                        <Variable list="false" local="false" variableName="targetalt_m" />
                        <Variable list="false" local="false" variableName="ascent_apoapsis_buffer_m" />
                      </BinaryOp>
                    </Comparison>
                    <Comparison op="ge" style="op-gte">
                      <CraftProperty property="Altitude.AGL" style="prop-altitude" />
                      <BinaryOp op="*" style="op-mul">
                        <Variable list="false" local="false" variableName="targetalt_m" />
                        <Variable list="false" local="false" variableName="ascent_circ_entry_altitude_ratio" />
                      </BinaryOp>
                    </Comparison>
                  </BoolOp>
                  <Instructions>
                    <SetVariable id="123" style="set-variable">
                      <Variable list="false" local="false" variableName="fc_mode" />
                      <Variable list="false" local="false" variableName="fc_mode_circularization" />
                    </SetVariable>
                    <SetVariable id="124" style="set-variable">
                      <Variable list="false" local="false" variableName="circ_active" />
                      <Constant text="1" />
                    </SetVariable>
                  </Instructions>
                </If>
              </Instructions>
            </ElseIf>
            <ElseIf id="125" style="else">
              <Comparison op="=" style="op-eq">
                <Variable list="false" local="false" variableName="fc_mode" />
                <Variable list="false" local="false" variableName="fc_mode_circularization" />
              </Comparison>
              <Instructions>
                <SetVariable id="126" style="set-variable">
                  <Variable list="false" local="false" variableName="fc_status_code" />
                  <Constant text="30" />
                </SetVariable>
                <SetVariable id="127" style="set-variable">
                  <Variable list="false" local="false" variableName="attowner" />
                  <Variable list="false" local="false" variableName="attowner_circularization" />
                </SetVariable>
                <SetVariable id="128" style="set-variable">
                  <Variable list="false" local="false" variableName="throwner" />
                  <Variable list="false" local="false" variableName="throwner_circularization" />
                </SetVariable>
              </Instructions>
            </ElseIf>
            <ElseIf id="129" style="else">
              <Comparison op="=" style="op-eq">
                <Variable list="false" local="false" variableName="fc_mode" />
                <Variable list="false" local="false" variableName="fc_mode_done" />
              </Comparison>
              <Instructions>
                <SetVariable id="130" style="set-variable">
                  <Variable list="false" local="false" variableName="fc_status_code" />
                  <Constant text="40" />
                </SetVariable>
                <If id="131" style="if">
                  <Comparison op="=" style="op-eq">
                    <Variable list="false" local="false" variableName="circ_active" />
                    <Constant number="0" />
                  </Comparison>
                  <Instructions>
                    <SetVariable id="132" style="set-variable">
                      <Variable list="false" local="false" variableName="fc_mode" />
                      <Variable list="false" local="false" variableName="fc_mode_none" />
                    </SetVariable>
                    <SetVariable id="133" style="set-variable">
                      <Variable list="false" local="false" variableName="attowner" />
                      <Variable list="false" local="false" variableName="attowner_none" />
                    </SetVariable>
                    <SetVariable id="134" style="set-variable">
                      <Variable list="false" local="false" variableName="throwner" />
                      <Variable list="false" local="false" variableName="throwner_none" />
                    </SetVariable>
                    <SetVariable id="135" style="set-variable">
                      <Variable list="false" local="false" variableName="fc_status_code" />
                      <Constant text="0" />
                    </SetVariable>
                  </Instructions>
                </If>
              </Instructions>
            </ElseIf>
          </Instructions>
        </ElseIf>
        <WaitSeconds id="136" style="wait-seconds">
          <Constant text="0.05" />
        </WaitSeconds>
      </Instructions>
    </While>
  </Instructions>
  <Instructions>
    <Event event="FlightStart" id="137" style="flight-start" pos="4003.454,-1469.869" />
    <Comment id="138" style="comment">
      <Constant style="comment-text" canReplace="false" text="Autostager (rewritten: gated, debounced, single-fire per depletion event)" />
    </Comment>
    <WaitUntil id="139" style="wait-until">
      <Comparison op="=" style="op-eq">
        <Variable list="false" local="false" variableName="fc_init_done" />
        <Constant text="1" />
      </Comparison>
    </WaitUntil>
    <WaitUntil id="140" style="wait-until">
      <Comparison op="ge" style="op-gte">
        <Variable list="false" local="false" variableName="fc_mode" />
        <Variable list="false" local="false" variableName="fc_mode_ascent" />
      </Comparison>
    </WaitUntil>
    <SetVariable id="141" style="set-variable">
      <Variable list="false" local="false" variableName="stagelock" />
      <Constant text="1" />
    </SetVariable>
    <SetVariable id="142" style="set-variable">
      <Variable list="false" local="false" variableName="lowfuelcount" />
      <Constant number="0" />
    </SetVariable>
    <SetVariable id="143" style="set-variable">
      <Variable list="false" local="false" variableName="lowthrustcount" />
      <Constant number="0" />
    </SetVariable>
    <WaitSeconds id="144" style="wait-seconds">
      <Constant text="1" />
    </WaitSeconds>
    <While id="145" style="while">
      <Constant style="true" bool="true" />
      <Instructions>
        <If id="146" style="if">
          <Comparison op="=" style="op-eq">
            <Variable list="false" local="false" variableName="init" />
            <Constant text="0" />
          </Comparison>
          <Instructions>
            <SetVariable id="154" style="set-variable">
              <Variable list="false" local="false" variableName="lowfuelcount" />
              <Constant number="0" />
            </SetVariable>
            <SetVariable id="155" style="set-variable">
              <Variable list="false" local="false" variableName="lowthrustcount" />
              <Constant number="0" />
            </SetVariable>
            <SetVariable id="156" style="set-variable">
              <Variable list="false" local="false" variableName="stagelock" />
              <Constant number="1" />
            </SetVariable>
            <WaitSeconds id="147" style="wait-seconds">
              <Constant text="0.05" />
            </WaitSeconds>
          </Instructions>
        </If>
        <ElseIf id="475" style="else">
          <Constant bool="true" />
          <Instructions>
            <If id="148" style="if">
              <BoolOp op="or" style="op-or">
                <Comparison op="=" style="op-eq">
                  <Variable list="false" local="false" variableName="init" />
                  <Constant text="0" />
                </Comparison>
                <Comparison op="l" style="op-lt">
                  <CraftProperty property="Input.Throttle" style="prop-input" />
                  <Constant text=".5" />
                </Comparison>
              </BoolOp>
              <Instructions>
                <SetVariable id="159" style="set-variable">
                  <Variable list="false" local="false" variableName="lowfuelcount" />
                  <Constant number="0" />
                </SetVariable>
                <SetVariable id="163" style="set-variable">
                  <Variable list="false" local="false" variableName="lowthrustcount" />
                  <Constant number="0" />
                </SetVariable>
                <SetVariable id="151" style="set-variable">
                  <Variable list="false" local="false" variableName="stagelock" />
                  <Constant text="1" />
                </SetVariable>
                <WaitSeconds id="149" style="wait-seconds">
                  <Constant text="0.05" />
                </WaitSeconds>
              </Instructions>
            </If>
            <ElseIf id="162" style="else">
              <Constant bool="true" />
              <Instructions>
                <If id="158" style="if">
                  <Comparison op="l" style="op-lt">
                    <CraftProperty property="Fuel.FuelInStage" style="prop-fuel" />
                    <Constant text="0.1" />
                  </Comparison>
                  <Instructions>
                    <SetVariable id="160" style="set-variable">
                      <Variable list="false" local="false" variableName="lowfuelcount" />
                      <BinaryOp op="+" style="op-add">
                        <Variable list="false" local="false" variableName="lowfuelcount" />
                        <Constant text="1" />
                      </BinaryOp>
                    </SetVariable>
                  </Instructions>
                </If>
                <ElseIf id="164" style="else">
                  <Constant bool="true" />
                  <Instructions>
                    <SetVariable id="165" style="set-variable">
                      <Variable list="false" local="false" variableName="lowfuelcount" />
                      <Constant number="0" />
                    </SetVariable>
                  </Instructions>
                </ElseIf>
                <If id="150" style="if">
                  <Comparison op="g" style="op-gt">
                    <CraftProperty property="Performance.MaxActiveEngineThrust" style="prop-performance" />
                    <Constant number="0" />
                  </Comparison>
                  <Instructions>
                    <If id="153" style="if">
                      <Comparison op="l" style="op-lt">
                        <CraftProperty property="Performance.CurrentEngineThrust" style="prop-performance" />
                        <BinaryOp op="*" style="op-mul">
                          <CraftProperty property="Performance.MaxActiveEngineThrust" style="prop-performance" />
                          <Constant text=".2" />
                        </BinaryOp>
                      </Comparison>
                      <Instructions>
                        <SetVariable id="473" style="set-variable">
                          <Variable list="false" local="false" variableName="lowthrustcount" />
                          <BinaryOp op="+" style="op-add">
                            <Variable list="false" local="false" variableName="lowthrustcount" />
                            <Constant text="1" />
                          </BinaryOp>
                        </SetVariable>
                      </Instructions>
                    </If>
                    <ElseIf id="476" style="else">
                      <Constant bool="true" />
                      <Instructions>
                        <SetVariable id="477" style="set-variable">
                          <Variable list="false" local="false" variableName="lowthrustcount" />
                          <Constant number="0" />
                        </SetVariable>
                      </Instructions>
                    </ElseIf>
                    <If id="152" style="if">
                      <BoolOp op="and" style="op-and">
                        <Comparison op="=" style="op-eq">
                          <Variable list="false" local="false" variableName="stagelock" />
                          <Constant text="1" />
                        </Comparison>
                        <Comparison op="ge" style="op-gte">
                          <CraftProperty property="Performance.CurrentEngineThrust" style="prop-performance" />
                          <BinaryOp op="*" style="op-mul">
                            <CraftProperty property="Performance.MaxActiveEngineThrust" style="prop-performance" />
                            <Constant text=".6" />
                          </BinaryOp>
                        </Comparison>
                      </BoolOp>
                      <Instructions>
                        <SetVariable id="478" style="set-variable">
                          <Variable list="false" local="false" variableName="stagelock" />
                          <Constant text="0" />
                        </SetVariable>
                      </Instructions>
                    </If>
                  </Instructions>
                </If>
                <ElseIf id="474" style="else">
                  <Constant bool="true" />
                  <Instructions>
                    <SetVariable id="170" style="set-variable">
                      <Variable list="false" local="false" variableName="lowthrustcount" />
                      <Constant number="0" />
                    </SetVariable>
                    <SetVariable id="168" style="set-variable">
                      <Variable list="false" local="false" variableName="stagelock" />
                      <Constant text="0" />
                    </SetVariable>
                  </Instructions>
                </ElseIf>
                <If id="166" style="if">
                  <BoolOp op="and" style="op-and">
                    <Comparison op="=" style="op-eq">
                      <Variable list="false" local="false" variableName="fc_mode" />
                      <Variable list="false" local="false" variableName="fc_mode_ascent" />
                    </Comparison>
                    <BoolOp op="and" style="op-and">
                    <Comparison op="=" style="op-eq">
                      <Variable list="false" local="false" variableName="stagelock" />
                      <Constant number="0" />
                    </Comparison>
                      <BoolOp op="and" style="op-and">
                        <Comparison op="ge" style="op-gte">
                          <Variable list="false" local="false" variableName="lowfuelcount" />
                          <Constant text="3" />
                        </Comparison>
                        <BoolOp op="and" style="op-and">
                          <Comparison op="ge" style="op-gte">
                            <Variable list="false" local="false" variableName="lowthrustcount" />
                            <Constant text="3" />
                          </Comparison>
                          <Comparison op="ge" style="op-gte">
                            <CraftProperty property="Altitude.AGL" style="prop-altitude" />
                            <Constant text="10000" />
                          </Comparison>
                        </BoolOp>
                      </BoolOp>
                    </BoolOp>
                  </BoolOp>
                  <Instructions>
                    <ActivateStage id="167" style="activate-stage" />
                    <SetVariable id="169" style="set-variable">
                      <Variable list="false" local="false" variableName="lowfuelcount" />
                      <Constant number="0" />
                    </SetVariable>
                    <SetVariable id="171" style="set-variable">
                      <Variable list="false" local="false" variableName="lowthrustcount" />
                      <Constant number="0" />
                    </SetVariable>
                    <SetVariable id="172" style="set-variable">
                      <Variable list="false" local="false" variableName="stagelock" />
                      <Constant text="1" />
                    </SetVariable>
                    <LogFlight id="173" style="flightlog">
                      <Constant text="autostage: stage activated" />
                      <Constant style="false" bool="false" />
                    </LogFlight>
                    <WaitSeconds id="161" style="wait-seconds">
                      <Constant text="1.0" />
                    </WaitSeconds>
                  </Instructions>
                </If>
                <WaitSeconds id="157" style="wait-seconds">
                  <Constant text="0.05" />
                </WaitSeconds>
              </Instructions>
            </ElseIf>
          </Instructions>
        </ElseIf>
      </Instructions>
    </While>
  </Instructions>
  <Instructions>
    <Event event="FlightStart" id="174" style="flight-start" pos="4864.378,1133.246" />
    <Comment id="175" style="comment">
      <Constant style="comment-text" canReplace="false" text="Throttle Manager (single-branch control path with clamp + circularization guard)" />
    </Comment>
    <WaitUntil id="176" style="wait-until">
      <Comparison op="=" style="op-eq">
        <Variable list="false" local="false" variableName="fc_init_done" />
        <Constant text="1" />
      </Comparison>
    </WaitUntil>
    <SetVariable id="178" style="set-variable">
      <Variable list="false" local="false" variableName="twr_target_gt" />
      <Constant text="1.4" />
    </SetVariable>
    <SetVariable id="179" style="set-variable">
      <Variable list="false" local="false" variableName="twr_target_peg" />
      <Constant text="1.35" />
    </SetVariable>
    <SetVariable id="180" style="set-variable">
      <Variable list="false" local="false" variableName="minthrottle" />
      <Constant text=".05" />
    </SetVariable>
    <SetVariable id="181" style="set-variable">
      <Variable list="false" local="false" variableName="maxthrottle" />
      <Constant text="1" />
    </SetVariable>
    <SetVariable id="182" style="set-variable">
      <Variable list="false" local="false" variableName="circ_toldv" />
      <Constant text=".5" />
    </SetVariable>
    <SetVariable id="183" style="set-variable">
      <Variable list="false" local="false" variableName="circ_minthrust" />
      <Constant text="1" />
    </SetVariable>
    <While id="184" style="while">
      <Constant style="true" bool="true" />
      <Instructions>
        <SetVariable id="194" style="set-variable">
          <Variable list="false" local="false" variableName="m" />
          <CraftProperty property="Performance.Mass" style="prop-performance" />
        </SetVariable>
        <SetVariable id="195" style="set-variable">
          <Variable list="false" local="false" variableName="maxt" />
          <CraftProperty property="Performance.MaxActiveEngineThrust" style="prop-performance" />
        </SetVariable>
        <SetVariable id="197" style="set-variable">
          <Variable list="false" local="false" variableName="gmag" />
          <VectorOp op="length" style="vec-op-1">
            <CraftProperty property="Vel.Gravity" style="prop-velocity" />
          </VectorOp>
        </SetVariable>
        <If id="185" style="if">
          <Comparison op="=" style="op-eq">
            <ActivationGroup style="activation-group">
              <Constant number="1" />
            </ActivationGroup>
            <Constant style="true" bool="true" />
          </Comparison>
          <Instructions>
            <SetInput input="throttle" id="190" style="set-input">
              <Constant number="0" />
            </SetInput>
          </Instructions>
        </If>
        <ElseIf id="187" style="else">
          <Comparison op="=" style="op-eq">
            <Variable list="false" local="false" variableName="fc_mode" />
            <Variable list="false" local="false" variableName="fc_mode_none" />
          </Comparison>
          <Instructions>
            <SetInput input="throttle" id="199" style="set-input">
              <Constant number="0" />
            </SetInput>
          </Instructions>
        </ElseIf>
        <ElseIf id="189" style="else">
          <Comparison op="=" style="op-eq">
            <Variable list="false" local="false" variableName="thrcut" />
            <Constant text="1" />
          </Comparison>
          <Instructions>
            <SetInput input="throttle" id="206" style="set-input">
              <Constant number="0" />
            </SetInput>
          </Instructions>
        </ElseIf>
        <ElseIf id="192" style="else">
          <Comparison op="l" style="op-lt">
            <Variable list="false" local="false" variableName="maxt" />
            <Constant text="1" />
          </Comparison>
          <Instructions>
            <SetInput input="throttle" id="214" style="set-input">
              <Constant number="0" />
            </SetInput>
          </Instructions>
        </ElseIf>
        <ElseIf id="200" style="else">
          <Comparison op="=" style="op-eq">
            <Variable list="false" local="false" variableName="throwner" />
            <Variable list="false" local="false" variableName="throwner_gravity_turn" />
          </Comparison>
          <Instructions>
            <SetVariable id="201" style="set-variable">
              <Variable list="false" local="false" variableName="thr" />
              <BinaryOp op="/" style="op-div">
                <BinaryOp op="*" style="op-mul">
                  <Variable list="false" local="false" variableName="twr_target_gt" />
                  <BinaryOp op="*" style="op-mul">
                    <Variable list="false" local="false" variableName="m" />
                    <Variable list="false" local="false" variableName="gmag" />
                  </BinaryOp>
                </BinaryOp>
                <Variable list="false" local="false" variableName="maxt" />
              </BinaryOp>
            </SetVariable>
          </Instructions>
        </ElseIf>
        <ElseIf id="208" style="else">
          <Comparison op="=" style="op-eq">
            <Variable list="false" local="false" variableName="throwner" />
            <Variable list="false" local="false" variableName="throwner_guidance" />
          </Comparison>
          <Instructions>
            <SetVariable id="209" style="set-variable">
              <Variable list="false" local="false" variableName="thr" />
              <BinaryOp op="/" style="op-div">
                <BinaryOp op="*" style="op-mul">
                  <Variable list="false" local="false" variableName="twr_target_peg" />
                  <BinaryOp op="*" style="op-mul">
                    <Variable list="false" local="false" variableName="m" />
                    <Variable list="false" local="false" variableName="gmag" />
                  </BinaryOp>
                </BinaryOp>
                <Variable list="false" local="false" variableName="maxt" />
              </BinaryOp>
            </SetVariable>
          </Instructions>
        </ElseIf>
        <ElseIf id="216" style="else">
          <BoolOp op="and" style="op-and">
            <Comparison op="=" style="op-eq">
              <Variable list="false" local="false" variableName="throwner" />
              <Variable list="false" local="false" variableName="throwner_circularization" />
            </Comparison>
            <BoolOp op="and" style="op-and">
              <Comparison op="=" style="op-eq">
                <Variable list="false" local="false" variableName="attowner" />
                <Variable list="false" local="false" variableName="attowner_circularization" />
              </Comparison>
              <Comparison op="=" style="op-eq">
                <Variable list="false" local="false" variableName="circ_active" />
                <Constant text="1" />
              </Comparison>
            </BoolOp>
          </BoolOp>
          <Instructions>
            <SetVariable id="219" style="set-variable">
              <Variable list="false" local="false" variableName="rvec" />
              <CraftProperty property="Nav.Position" style="prop-nav" />
            </SetVariable>
            <SetVariable id="220" style="set-variable">
              <Variable list="false" local="false" variableName="rmag" />
              <VectorOp op="length" style="vec-op-1">
                <Variable list="false" local="false" variableName="rvec" />
              </VectorOp>
            </SetVariable>
            <SetVariable id="221" style="set-variable">
              <Variable list="false" local="false" variableName="mu" />
              <BinaryOp op="*" style="op-mul">
                <Variable list="false" local="false" variableName="gmag" />
                <BinaryOp op="^" style="op-exp">
                  <Variable list="false" local="false" variableName="rmag" />
                  <Constant text="2" />
                </BinaryOp>
              </BinaryOp>
            </SetVariable>
            <SetVariable id="222" style="set-variable">
              <Variable list="false" local="false" variableName="r" />
              <Planet op="radius" style="planet">
                <Constant text="Droo" />
              </Planet>
            </SetVariable>
            <SetVariable id="223" style="set-variable">
              <Variable list="false" local="false" variableName="ra" />
              <BinaryOp op="+" style="op-add">
                <Variable list="false" local="false" variableName="r" />
                <CraftProperty property="Orbit.Apoapsis" style="prop-orbit" />
              </BinaryOp>
            </SetVariable>
            <If id="224" style="if">
              <Comparison op="l" style="op-lt">
                <Variable list="false" local="false" variableName="ra" />
                <BinaryOp op="+" style="op-add">
                  <Variable list="false" local="false" variableName="r" />
                  <Constant text="1" />
                </BinaryOp>
              </Comparison>
              <Instructions>
                <SetVariable id="225" style="set-variable">
                  <Variable list="false" local="false" variableName="ra" />
                  <BinaryOp op="+" style="op-add">
                    <Variable list="false" local="false" variableName="r" />
                    <Constant text="1" />
                  </BinaryOp>
                </SetVariable>
              </Instructions>
            </If>
            <SetVariable id="226" style="set-variable">
              <Variable list="false" local="false" variableName="vcirc" />
              <MathFunction function="sqrt" style="op-math">
                <BinaryOp op="/" style="op-div">
                  <Variable list="false" local="false" variableName="mu" />
                  <Variable list="false" local="false" variableName="ra" />
                </BinaryOp>
              </MathFunction>
            </SetVariable>
            <SetVariable id="227" style="set-variable">
              <Variable list="false" local="false" variableName="vnow" />
              <VectorOp op="length" style="vec-op-1">
                <CraftProperty property="Vel.OrbitVelocity" style="prop-velocity" />
              </VectorOp>
            </SetVariable>
            <SetVariable id="228" style="set-variable">
              <Variable list="false" local="false" variableName="dv" />
              <BinaryOp op="-" style="op-sub">
                <Variable list="false" local="false" variableName="vcirc" />
                <Variable list="false" local="false" variableName="vnow" />
              </BinaryOp>
            </SetVariable>
            <If id="229" style="if">
              <Comparison op="l" style="op-lt">
                <Variable list="false" local="false" variableName="dv" />
                <Constant text="0" />
              </Comparison>
              <Instructions>
                <SetVariable id="230" style="set-variable">
                  <Variable list="false" local="false" variableName="dv" />
                  <Constant text="0" />
                </SetVariable>
              </Instructions>
            </If>
            <If id="231" style="if">
              <Comparison op="l" style="op-lt">
                <CraftProperty property="Altitude.AGL" style="prop-altitude" />
                <BinaryOp op="-" style="op-sub">
                  <CraftProperty property="Orbit.Apoapsis" style="prop-orbit" />
                  <Variable list="false" local="false" variableName="ascent_apoapsis_buffer_m" />
                </BinaryOp>
              </Comparison>
              <Instructions>
                <SetInput input="throttle" id="232" style="set-input">
                  <Constant number="0" />
                </SetInput>
              </Instructions>
            </If>
            <ElseIf id="233" style="else">
              <Comparison op="le" style="op-lte">
                <Variable list="false" local="false" variableName="dv" />
                <Variable list="false" local="false" variableName="circ_toldv" />
              </Comparison>
              <Instructions>
                <SetInput input="throttle" id="239" style="set-input">
                  <Constant number="0" />
                </SetInput>
              </Instructions>
            </ElseIf>
            <ElseIf id="234" style="else">
              <Comparison op="l" style="op-lt">
                <Variable list="false" local="false" variableName="maxt" />
                <Variable list="false" local="false" variableName="circ_minthrust" />
              </Comparison>
              <Instructions>
                <SetInput input="throttle" id="240" style="set-input">
                  <Constant number="0" />
                </SetInput>
              </Instructions>
            </ElseIf>
            <ElseIf id="235" style="else">
              <Constant bool="true" />
              <Instructions>
                <SetVariable id="236" style="set-variable">
                  <Variable list="false" local="false" variableName="thr" />
                  <BinaryOp op="/" style="op-div">
                    <Variable list="false" local="false" variableName="dv" />
                    <Variable list="false" local="false" variableName="circularization_gain_divisor" />
                  </BinaryOp>
                </SetVariable>
              </Instructions>
            </ElseIf>
          </Instructions>
        </ElseIf>
        <ElseIf id="237" style="else">
          <BoolOp op="and" style="op-and">
            <Comparison op="=" style="op-eq">
              <Variable list="false" local="false" variableName="throwner" />
              <Variable list="false" local="false" variableName="throwner_none" />
            </Comparison>
            <Not style="op-not">
              <Comparison op="=" style="op-eq">
                <Variable list="false" local="false" variableName="fc_mode" />
                <Variable list="false" local="false" variableName="fc_mode_countdown" />
              </Comparison>
            </Not>
          </BoolOp>
          <Instructions>
            <SetInput input="throttle" id="238" style="set-input">
              <Constant number="0" />
            </SetInput>
          </Instructions>
        </ElseIf>
        <ElseIf id="3623" style="else">
          <Not style="op-not">
            <Comparison op="=" style="op-eq">
              <Variable list="false" local="false" variableName="fc_mode" />
              <Variable list="false" local="false" variableName="fc_mode_countdown" />
            </Comparison>
          </Not>
          <Instructions>
            <SetInput input="throttle" id="241" style="set-input">
              <Constant number="0" />
            </SetInput>
          </Instructions>
        </ElseIf>
        <If id="202" style="if">
          <Comparison op="l" style="op-lt">
            <Variable list="false" local="false" variableName="thr" />
            <Variable list="false" local="false" variableName="minthrottle" />
          </Comparison>
          <Instructions>
            <SetVariable id="203" style="set-variable">
              <Variable list="false" local="false" variableName="thr" />
              <Variable list="false" local="false" variableName="minthrottle" />
            </SetVariable>
          </Instructions>
        </If>
        <If id="204" style="if">
          <Comparison op="g" style="op-gt">
            <Variable list="false" local="false" variableName="thr" />
            <Variable list="false" local="false" variableName="maxthrottle" />
          </Comparison>
          <Instructions>
            <SetVariable id="205" style="set-variable">
              <Variable list="false" local="false" variableName="thr" />
              <Variable list="false" local="false" variableName="maxthrottle" />
            </SetVariable>
          </Instructions>
        </If>
        <If id="207" style="if">
          <BoolOp op="or" style="op-or">
            <Comparison op="=" style="op-eq">
              <Variable list="false" local="false" variableName="throwner" />
              <Variable list="false" local="false" variableName="throwner_gravity_turn" />
            </Comparison>
            <BoolOp op="or" style="op-or">
              <Comparison op="=" style="op-eq">
                <Variable list="false" local="false" variableName="throwner" />
                <Variable list="false" local="false" variableName="throwner_guidance" />
              </Comparison>
              <BoolOp op="and" style="op-and">
                <Comparison op="=" style="op-eq">
                  <Variable list="false" local="false" variableName="throwner" />
                  <Variable list="false" local="false" variableName="throwner_circularization" />
                </Comparison>
                <Comparison op="g" style="op-gt">
                  <Variable list="false" local="false" variableName="dv" />
                  <Variable list="false" local="false" variableName="circ_toldv" />
                </Comparison>
              </BoolOp>
            </BoolOp>
          </BoolOp>
          <Instructions>
            <SetInput input="throttle" id="215" style="set-input">
              <Variable list="false" local="false" variableName="thr" />
            </SetInput>
          </Instructions>
        </If>
        <WaitSeconds id="218" style="wait-seconds">
          <Constant text="0.05" />
        </WaitSeconds>
      </Instructions>
    </While>
  </Instructions>
  <Instructions>
    <Event event="FlightStart" id="242" style="flight-start" pos="5576.908,1049.918" />
    <Comment id="243" style="comment">
      <Constant style="comment-text" canReplace="false" text="Circularize (burn guidance frame-synced; inactive gates 0.05s)" />
    </Comment>
    <WaitUntil id="244" style="wait-until">
      <Comparison op="=" style="op-eq">
        <Variable list="false" local="false" variableName="fc_init_done" />
        <Constant text="1" />
      </Comparison>
    </WaitUntil>
    <WaitUntil id="245" style="wait-until">
      <Comparison op="=" style="op-eq">
        <Variable list="false" local="false" variableName="fc_mode" />
        <Variable list="false" local="false" variableName="fc_mode_circularization" />
      </Comparison>
    </WaitUntil>
    <SetVariable id="246" style="set-variable">
      <Variable list="false" local="false" variableName="circ_tolalt" />
      <Constant text="500" />
    </SetVariable>
    <SetVariable id="247" style="set-variable">
      <Variable list="false" local="false" variableName="circ_toldv" />
      <Constant text=".5" />
    </SetVariable>
    <SetVariable id="248" style="set-variable">
      <Variable list="false" local="false" variableName="circ_minthrust" />
      <Constant text="1" />
    </SetVariable>
    <SetVariable id="249" style="set-variable">
      <Variable list="false" local="false" variableName="circ_mintime" />
      <Constant text=".1" />
    </SetVariable>
    <SetVariable id="250" style="set-variable">
      <Variable list="false" local="false" variableName="circlocked" />
      <Constant text="0" />
    </SetVariable>
    <While id="251" style="while">
      <Constant style="true" bool="true" />
      <Instructions>
        <If id="252" style="if">
          <BoolOp op="or" style="op-or">
            <Comparison op="=" style="op-eq">
              <Variable list="false" local="false" variableName="circ_active" />
              <Constant number="0" />
            </Comparison>
            <Not style="op-not">
              <Comparison op="=" style="op-eq">
                <Variable list="false" local="false" variableName="attowner" />
                <Variable list="false" local="false" variableName="attowner_circularization" />
              </Comparison>
            </Not>
          </BoolOp>
          <Instructions>
            <If id="253" style="if">
              <Comparison op="=" style="op-eq">
                <Variable list="false" local="false" variableName="circlocked" />
                <Constant text="1" />
              </Comparison>
              <Instructions>
                <LockNavSphere indicatorType="None" id="254" style="lock-nav-sphere" />
                <SetVariable id="255" style="set-variable">
                  <Variable list="false" local="false" variableName="circlocked" />
                  <Constant text="0" />
                </SetVariable>
              </Instructions>
            </If>
            <WaitSeconds id="256" style="wait-seconds">
              <Constant text="0.05" />
            </WaitSeconds>
          </Instructions>
        </If>
        <If id="262" style="if">
          <Comparison op="=" style="op-eq">
            <ActivationGroup style="activation-group">
              <Constant number="1" />
            </ActivationGroup>
            <Constant style="true" bool="true" />
          </Comparison>
          <Instructions>
            <If id="263" style="if">
              <Comparison op="=" style="op-eq">
                <Variable list="false" local="false" variableName="circlocked" />
                <Constant text="1" />
              </Comparison>
              <Instructions>
                <LockNavSphere indicatorType="None" id="264" style="lock-nav-sphere" />
                <SetVariable id="265" style="set-variable">
                  <Variable list="false" local="false" variableName="circlocked" />
                  <Constant text="0" />
                </SetVariable>
              </Instructions>
            </If>
            <SetVariable id="266" style="set-variable">
              <Variable list="false" local="false" variableName="thrcut" />
              <Constant text="1" />
            </SetVariable>
            <WaitSeconds id="267" style="wait-seconds">
              <Constant text="0.05" />
            </WaitSeconds>
          </Instructions>
        </If>
        <If id="2680" style="if">
          <Not style="op-not">
            <BoolOp op="or" style="op-or">
              <BoolOp op="or" style="op-or">
                <Comparison op="=" style="op-eq">
                  <Variable list="false" local="false" variableName="circ_active" />
                  <Constant number="0" />
                </Comparison>
                <Not style="op-not">
                  <Comparison op="=" style="op-eq">
                    <Variable list="false" local="false" variableName="attowner" />
                    <Variable list="false" local="false" variableName="attowner_circularization" />
                  </Comparison>
                </Not>
              </BoolOp>
              <Comparison op="=" style="op-eq">
                <ActivationGroup style="activation-group">
                  <Constant number="1" />
                </ActivationGroup>
                <Constant style="true" bool="true" />
              </Comparison>
            </BoolOp>
          </Not>
          <Instructions>
            <SetVariable id="268" style="set-variable">
          <Variable list="false" local="false" variableName="rvec" />
          <CraftProperty property="Nav.Position" style="prop-nav" />
        </SetVariable>
        <SetVariable id="269" style="set-variable">
          <Variable list="false" local="false" variableName="gvec" />
          <CraftProperty property="Vel.Gravity" style="prop-velocity" />
        </SetVariable>
        <SetVariable id="270" style="set-variable">
          <Variable list="false" local="false" variableName="rmag" />
          <VectorOp op="length" style="vec-op-1">
            <Variable list="false" local="false" variableName="rvec" />
          </VectorOp>
        </SetVariable>
        <SetVariable id="271" style="set-variable">
          <Variable list="false" local="false" variableName="gmag" />
          <VectorOp op="length" style="vec-op-1">
            <Variable list="false" local="false" variableName="gvec" />
          </VectorOp>
        </SetVariable>
        <SetVariable id="272" style="set-variable">
          <Variable list="false" local="false" variableName="mu" />
          <BinaryOp op="*" style="op-mul">
            <Variable list="false" local="false" variableName="gmag" />
            <BinaryOp op="^" style="op-exp">
              <Variable list="false" local="false" variableName="rmag" />
              <Constant text="2" />
            </BinaryOp>
          </BinaryOp>
        </SetVariable>
        <SetVariable id="273" style="set-variable">
          <Variable list="false" local="false" variableName="r" />
          <Planet op="radius" style="planet">
            <Constant text="Droo" />
          </Planet>
        </SetVariable>
        <SetVariable id="274" style="set-variable">
          <Variable list="false" local="false" variableName="ra" />
          <BinaryOp op="+" style="op-add">
            <Variable list="false" local="false" variableName="r" />
            <CraftProperty property="Orbit.Apoapsis" style="prop-orbit" />
          </BinaryOp>
        </SetVariable>
        <If id="275" style="if">
          <Comparison op="l" style="op-lt">
            <Variable list="false" local="false" variableName="ra" />
            <BinaryOp op="+" style="op-add">
              <Variable list="false" local="false" variableName="r" />
              <Constant text="1" />
            </BinaryOp>
          </Comparison>
          <Instructions>
            <SetVariable id="276" style="set-variable">
              <Variable list="false" local="false" variableName="ra" />
              <BinaryOp op="+" style="op-add">
                <Variable list="false" local="false" variableName="r" />
                <Constant text="1" />
              </BinaryOp>
            </SetVariable>
          </Instructions>
        </If>
        <SetVariable id="277" style="set-variable">
          <Variable list="false" local="false" variableName="vcirc" />
          <MathFunction function="sqrt" style="op-math">
            <BinaryOp op="/" style="op-div">
              <Variable list="false" local="false" variableName="mu" />
              <Variable list="false" local="false" variableName="ra" />
            </BinaryOp>
          </MathFunction>
        </SetVariable>
        <SetVariable id="278" style="set-variable">
          <Variable list="false" local="false" variableName="vnow" />
          <VectorOp op="length" style="vec-op-1">
            <CraftProperty property="Vel.OrbitVelocity" style="prop-velocity" />
          </VectorOp>
        </SetVariable>
        <SetVariable id="279" style="set-variable">
          <Variable list="false" local="false" variableName="dv" />
          <BinaryOp op="-" style="op-sub">
            <Variable list="false" local="false" variableName="vcirc" />
            <Variable list="false" local="false" variableName="vnow" />
          </BinaryOp>
        </SetVariable>
        <If id="280" style="if">
          <Comparison op="l" style="op-lt">
            <Variable list="false" local="false" variableName="dv" />
            <Constant text="0" />
          </Comparison>
          <Instructions>
            <SetVariable id="281" style="set-variable">
              <Variable list="false" local="false" variableName="dv" />
              <Constant text="0" />
            </SetVariable>
          </Instructions>
        </If>
        <SetVariable id="282" style="set-variable">
          <Variable list="false" local="false" variableName="m" />
          <CraftProperty property="Performance.Mass" style="prop-performance" />
        </SetVariable>
        <SetVariable id="283" style="set-variable">
          <Variable list="false" local="false" variableName="maxt" />
          <CraftProperty property="Performance.MaxActiveEngineThrust" style="prop-performance" />
        </SetVariable>
        <If id="284" style="if">
          <Comparison op="l" style="op-lt">
            <Variable list="false" local="false" variableName="maxt" />
            <Variable list="false" local="false" variableName="circ_minthrust" />
          </Comparison>
          <Instructions>
            <SetVariable id="285" style="set-variable">
              <Variable list="false" local="false" variableName="thrcut" />
              <Constant text="1" />
            </SetVariable>
            <If id="286" style="if">
              <Comparison op="=" style="op-eq">
                <Variable list="false" local="false" variableName="circlocked" />
                <Constant text="1" />
              </Comparison>
              <Instructions>
                <LockNavSphere indicatorType="None" id="287" style="lock-nav-sphere" />
                <SetVariable id="288" style="set-variable">
                  <Variable list="false" local="false" variableName="circlocked" />
                  <Constant text="0" />
                </SetVariable>
                <WaitSeconds id="289" style="wait-seconds">
                  <Constant text="0.05" />
                </WaitSeconds>
              </Instructions>
            </If>
            <SetVariable id="290" style="set-variable">
              <Variable list="false" local="false" variableName="circ_active" />
              <Constant text="0" />
            </SetVariable>
            <WaitSeconds id="291" style="wait-seconds">
              <Constant text="0.05" />
            </WaitSeconds>
          </Instructions>
        </If>
        <SetVariable id="292" style="set-variable">
          <Variable list="false" local="false" variableName="tburn" />
          <BinaryOp op="/" style="op-div">
            <BinaryOp op="*" style="op-mul">
              <Variable list="false" local="false" variableName="dv" />
              <Variable list="false" local="false" variableName="m" />
            </BinaryOp>
            <Variable list="false" local="false" variableName="maxt" />
          </BinaryOp>
        </SetVariable>
        <If id="293" style="if">
          <Comparison op="l" style="op-lt">
            <Variable list="false" local="false" variableName="tburn" />
            <Variable list="false" local="false" variableName="circ_mintime" />
          </Comparison>
          <Instructions>
            <SetVariable id="294" style="set-variable">
              <Variable list="false" local="false" variableName="tburn" />
              <Variable list="false" local="false" variableName="circ_mintime" />
            </SetVariable>
          </Instructions>
        </If>
        <SetVariable id="295" style="set-variable">
          <Variable list="false" local="false" variableName="burnstart" />
          <BinaryOp op="/" style="op-div">
            <Variable list="false" local="false" variableName="tburn" />
            <Constant text="2" />
          </BinaryOp>
        </SetVariable>
        <If id="296" style="if">
          <Comparison op="=" style="op-eq">
            <Variable list="false" local="false" variableName="circlocked" />
            <Constant number="0" />
          </Comparison>
          <Instructions>
            <LockNavSphere indicatorType="Prograde" id="297" style="lock-nav-sphere" />
            <SetVariable id="298" style="set-variable">
              <Variable list="false" local="false" variableName="circlocked" />
              <Constant text="1" />
            </SetVariable>
          </Instructions>
        </If>
        <While id="299" style="while">
          <Constant style="true" bool="true" />
          <Instructions>
            <If id="300" style="if">
              <Comparison op="=" style="op-eq">
                <ActivationGroup style="activation-group">
                  <Constant number="1" />
                </ActivationGroup>
                <Constant style="true" bool="true" />
              </Comparison>
              <Instructions>
                <SetVariable id="301" style="set-variable">
                  <Variable list="false" local="false" variableName="thrcut" />
                  <Constant text="1" />
                </SetVariable>
                <Break id="302" style="break" />
              </Instructions>
            </If>
            <If id="303" style="if">
              <Comparison op="=" style="op-eq">
                <Not style="op-not">
                  <Comparison op="=" style="op-eq">
                    <Variable list="false" local="false" variableName="attowner" />
                    <Variable list="false" local="false" variableName="attowner_circularization" />
                  </Comparison>
                </Not>
                <Constant style="true" bool="true" />
              </Comparison>
              <Instructions>
                <SetVariable id="304" style="set-variable">
                  <Variable list="false" local="false" variableName="thrcut" />
                  <Constant text="0" />
                </SetVariable>
                <Break id="305" style="break" />
              </Instructions>
            </If>
            <SetVariable id="306" style="set-variable">
              <Variable list="false" local="false" variableName="rvec" />
              <CraftProperty property="Nav.Position" style="prop-nav" />
            </SetVariable>
            <SetVariable id="307" style="set-variable">
              <Variable list="false" local="false" variableName="gvec" />
              <CraftProperty property="Vel.Gravity" style="prop-velocity" />
            </SetVariable>
            <SetVariable id="308" style="set-variable">
              <Variable list="false" local="false" variableName="rmag" />
              <VectorOp op="length" style="vec-op-1">
                <Variable list="false" local="false" variableName="rvec" />
              </VectorOp>
            </SetVariable>
            <SetVariable id="309" style="set-variable">
              <Variable list="false" local="false" variableName="gmag" />
              <VectorOp op="length" style="vec-op-1">
                <Variable list="false" local="false" variableName="gvec" />
              </VectorOp>
            </SetVariable>
            <SetVariable id="310" style="set-variable">
              <Variable list="false" local="false" variableName="mu" />
              <BinaryOp op="*" style="op-mul">
                <Variable list="false" local="false" variableName="gmag" />
                <BinaryOp op="^" style="op-exp">
                  <Variable list="false" local="false" variableName="rmag" />
                  <Constant text="2" />
                </BinaryOp>
              </BinaryOp>
            </SetVariable>
            <SetVariable id="311" style="set-variable">
              <Variable list="false" local="false" variableName="r" />
              <Planet op="radius" style="planet">
                <Constant text="Droo" />
              </Planet>
            </SetVariable>
            <SetVariable id="312" style="set-variable">
              <Variable list="false" local="false" variableName="ra" />
              <BinaryOp op="+" style="op-add">
                <Variable list="false" local="false" variableName="r" />
                <CraftProperty property="Orbit.Apoapsis" style="prop-orbit" />
              </BinaryOp>
            </SetVariable>
            <If id="313" style="if">
              <Comparison op="l" style="op-lt">
                <Variable list="false" local="false" variableName="ra" />
                <BinaryOp op="+" style="op-add">
                  <Variable list="false" local="false" variableName="r" />
                  <Constant text="1" />
                </BinaryOp>
              </Comparison>
              <Instructions>
                <SetVariable id="314" style="set-variable">
                  <Variable list="false" local="false" variableName="ra" />
                  <BinaryOp op="+" style="op-add">
                    <Variable list="false" local="false" variableName="r" />
                    <Constant text="1" />
                  </BinaryOp>
                </SetVariable>
              </Instructions>
            </If>
            <SetVariable id="315" style="set-variable">
              <Variable list="false" local="false" variableName="vcirc" />
              <MathFunction function="sqrt" style="op-math">
                <BinaryOp op="/" style="op-div">
                  <Variable list="false" local="false" variableName="mu" />
                  <Variable list="false" local="false" variableName="ra" />
                </BinaryOp>
              </MathFunction>
            </SetVariable>
            <SetVariable id="316" style="set-variable">
              <Variable list="false" local="false" variableName="vnow" />
              <VectorOp op="length" style="vec-op-1">
                <CraftProperty property="Vel.OrbitVelocity" style="prop-velocity" />
              </VectorOp>
            </SetVariable>
            <SetVariable id="317" style="set-variable">
              <Variable list="false" local="false" variableName="dv" />
              <BinaryOp op="-" style="op-sub">
                <Variable list="false" local="false" variableName="vcirc" />
                <Variable list="false" local="false" variableName="vnow" />
              </BinaryOp>
            </SetVariable>
            <If id="318" style="if">
              <Comparison op="l" style="op-lt">
                <Variable list="false" local="false" variableName="dv" />
                <Constant text="0" />
              </Comparison>
              <Instructions>
                <SetVariable id="319" style="set-variable">
                  <Variable list="false" local="false" variableName="dv" />
                  <Constant text="0" />
                </SetVariable>
              </Instructions>
            </If>
            <If id="320" style="if">
              <BoolOp op="and" style="op-and">
                <Comparison op="ge" style="op-gte">
                  <CraftProperty property="Orbit.Periapsis" style="prop-orbit" />
                  <BinaryOp op="-" style="op-sub">
                    <Variable list="false" local="false" variableName="targetalt_m" />
                    <Variable list="false" local="false" variableName="circ_tolalt" />
                  </BinaryOp>
                </Comparison>
                <Comparison op="le" style="op-lte">
                  <Variable list="false" local="false" variableName="dv" />
                  <Variable list="false" local="false" variableName="circ_toldv" />
                </Comparison>
              </BoolOp>
              <Instructions>
                <SetVariable id="321" style="set-variable">
                  <Variable list="false" local="false" variableName="thrcut" />
                  <Constant text="0" />
                </SetVariable>
                <LockNavSphere indicatorType="None" id="322" style="lock-nav-sphere" />
                <SetVariable id="323" style="set-variable">
                  <Variable list="false" local="false" variableName="circlocked" />
                  <Constant text="0" />
                </SetVariable>
                <SetVariable id="324" style="set-variable">
                  <Variable list="false" local="false" variableName="circ_active" />
                  <Constant text="0" />
                </SetVariable>
                <SetVariable id="325" style="set-variable">
                  <Variable list="false" local="false" variableName="fc_mode" />
                  <Variable list="false" local="false" variableName="fc_mode_done" />
                </SetVariable>
                <Break id="326" style="break" />
              </Instructions>
            </If>
            <WaitSeconds id="327" style="wait-seconds">
              <Constant text="0.05" />
            </WaitSeconds>
          </Instructions>
        </While>
        <WaitSeconds id="328" style="wait-seconds">
          <Constant text="0.05" />
        </WaitSeconds>
          </Instructions>
        </If>
      </Instructions>
    </While>
  </Instructions>
  <Instructions>
    <Event event="FlightStart" id="329" style="flight-start" pos="3039.282,1668.505" />
    <Comment id="330" style="comment">
      <Constant style="comment-text" canReplace="false" text="PEG Guidance (active guidance loop frame-synced; standby gate 0.05s)" />
    </Comment>
    <WaitUntil id="331" style="wait-until">
      <Comparison op="=" style="op-eq">
        <Variable list="false" local="false" variableName="fc_init_done" />
        <Constant text="1" />
      </Comparison>
    </WaitUntil>
    <SetVariable id="332" style="set-variable">
      <Variable list="false" local="false" variableName="escale" />
      <Constant text="500000" />
    </SetVariable>
    <SetVariable id="333" style="set-variable">
      <Variable list="false" local="false" variableName="k_e_max" />
      <Constant text=".6" />
    </SetVariable>
    <SetVariable id="334" style="set-variable">
      <Variable list="false" local="false" variableName="k_i_max" />
      <Constant text=".3" />
    </SetVariable>
    <SetVariable id="335" style="set-variable">
      <Variable list="false" local="false" variableName="peg_pitchcmd" />
      <Constant text="90" />
    </SetVariable>
    <SetVariable id="336" style="set-variable">
      <Variable list="false" local="false" variableName="peg_headingcmd" />
      <Constant text="90" />
    </SetVariable>
    <SetVariable id="337" style="set-variable">
      <Variable list="false" local="false" variableName="targetinc_rad" />
      <MathFunction function="deg2rad" style="op-math">
        <Variable list="false" local="false" variableName="targetinc_deg" />
      </MathFunction>
    </SetVariable>
    <WaitUntil id="338" style="wait-until">
      <Comparison op="=" style="op-eq">
        <Variable list="false" local="false" variableName="attowner" />
        <Variable list="false" local="false" variableName="attowner_guidance" />
      </Comparison>
    </WaitUntil>
    <DisplayMessage id="339" style="display">
      <Constant text="Initializing PEG Guidance" />
      <Constant number="7" />
    </DisplayMessage>
    <LogFlight id="340" style="flightlog">
      <Constant text="Initializing PEG Guidance" />
      <Constant style="false" bool="false" />
    </LogFlight>
    <While id="341" style="while">
      <Constant style="true" bool="true" />
      <Instructions>
        <If id="342" style="if">
          <Not style="op-not">
            <Comparison op="=" style="op-eq">
              <Variable list="false" local="false" variableName="attowner" />
              <Variable list="false" local="false" variableName="attowner_guidance" />
            </Comparison>
          </Not>
          <Instructions>
            <WaitSeconds id="343" style="wait-seconds">
              <Constant text="0.05" />
            </WaitSeconds>
          </Instructions>
        </If>
        <SetVariable id="344" style="set-variable">
          <Variable list="false" local="false" variableName="peg_htarget_ready" />
          <Constant number="0" />
        </SetVariable>
        <While id="345" style="while">
          <Comparison op="=" style="op-eq">
            <Variable list="false" local="false" variableName="attowner" />
            <Variable list="false" local="false" variableName="attowner_guidance" />
          </Comparison>
          <Instructions>
            <SetVariable id="346" style="set-variable">
              <Variable list="false" local="false" variableName="rvec" />
              <CraftProperty property="Nav.Position" style="prop-nav" />
            </SetVariable>
            <SetVariable id="347" style="set-variable">
              <Variable list="false" local="false" variableName="vvec" />
              <CraftProperty property="Vel.OrbitVelocity" style="prop-velocity" />
            </SetVariable>
            <SetVariable id="348" style="set-variable">
              <Variable list="false" local="false" variableName="rhat" />
              <VectorOp op="norm" style="vec-op-1">
                <Variable list="false" local="false" variableName="rvec" />
              </VectorOp>
            </SetVariable>
            <SetVariable id="349" style="set-variable">
              <Variable list="false" local="false" variableName="nhat" />
              <VectorOp op="norm" style="vec-op-1">
                <CraftProperty property="Nav.North" style="prop-nav" />
              </VectorOp>
            </SetVariable>
            <SetVariable id="350" style="set-variable">
              <Variable list="false" local="false" variableName="ehat" />
              <VectorOp op="norm" style="vec-op-1">
                <CraftProperty property="Nav.East" style="prop-nav" />
              </VectorOp>
            </SetVariable>
            <SetVariable id="351" style="set-variable">
              <Variable list="false" local="false" variableName="ki" />
              <Constant text="0" />
            </SetVariable>
            <If id="352" style="if">
              <Comparison op="=" style="op-eq">
                <Variable list="false" local="false" variableName="peg_readyk" />
                <Constant text="1" />
              </Comparison>
              <Instructions>
                <If id="353" style="if">
                  <Comparison op="=" style="op-eq">
                    <Variable list="false" local="false" variableName="peg_htarget_ready" />
                    <Constant text="0" />
                  </Comparison>
                  <Instructions>
                    <SetVariable id="354" style="set-variable">
                      <Variable list="false" local="false" variableName="peg_r0" />
                      <VectorOp op="norm" style="vec-op-1">
                        <CraftProperty property="Nav.Position" style="prop-nav" />
                      </VectorOp>
                    </SetVariable>
                    <SetVariable id="355" style="set-variable">
                      <Variable list="false" local="false" variableName="peg_nodeaxis" />
                      <VectorOp op="norm" style="vec-op-1">
                        <VectorOp op="cross" style="vec-op-2">
                          <Variable list="false" local="false" variableName="peg_k" />
                          <Variable list="false" local="false" variableName="peg_r0" />
                        </VectorOp>
                      </VectorOp>
                    </SetVariable>
                    <SetVariable id="356" style="set-variable">
                      <Variable list="false" local="false" variableName="targetinc_rad" />
                      <MathFunction function="deg2rad" style="op-math">
                        <Variable list="false" local="false" variableName="targetinc_deg" />
                      </MathFunction>
                    </SetVariable>
                    <SetVariable id="357" style="set-variable">
                      <Variable list="false" local="false" variableName="cosi" />
                      <MathFunction function="cos" style="op-math">
                        <Variable list="false" local="false" variableName="targetinc_rad" />
                      </MathFunction>
                    </SetVariable>
                    <SetVariable id="358" style="set-variable">
                      <Variable list="false" local="false" variableName="sini" />
                      <MathFunction function="sin" style="op-math">
                        <Variable list="false" local="false" variableName="targetinc_rad" />
                      </MathFunction>
                    </SetVariable>
                    <SetVariable id="359" style="set-variable">
                      <Variable list="false" local="false" variableName="term1" />
                      <BinaryOp op="*" style="op-mul">
                        <Variable list="false" local="false" variableName="peg_k" />
                        <Variable list="false" local="false" variableName="cosi" />
                      </BinaryOp>
                    </SetVariable>
                    <SetVariable id="360" style="set-variable">
                      <Variable list="false" local="false" variableName="term2" />
                      <BinaryOp op="*" style="op-mul">
                        <VectorOp op="cross" style="vec-op-2">
                          <Variable list="false" local="false" variableName="peg_nodeaxis" />
                          <Variable list="false" local="false" variableName="peg_k" />
                        </VectorOp>
                        <Variable list="false" local="false" variableName="sini" />
                      </BinaryOp>
                    </SetVariable>
                    <SetVariable id="361" style="set-variable">
                      <Variable list="false" local="false" variableName="term3" />
                      <BinaryOp op="*" style="op-mul">
                        <Variable list="false" local="false" variableName="peg_nodeaxis" />
                        <BinaryOp op="*" style="op-mul">
                          <VectorOp op="dot" style="vec-op-2">
                            <Variable list="false" local="false" variableName="peg_nodeaxis" />
                            <Variable list="false" local="false" variableName="peg_k" />
                          </VectorOp>
                          <BinaryOp op="-" style="op-sub">
                            <Constant text="1" />
                            <Variable list="false" local="false" variableName="cosi" />
                          </BinaryOp>
                        </BinaryOp>
                      </BinaryOp>
                    </SetVariable>
                    <SetVariable id="362" style="set-variable">
                      <Variable list="false" local="false" variableName="peg_htarget" />
                      <VectorOp op="norm" style="vec-op-1">
                        <BinaryOp op="+" style="op-add">
                          <Variable list="false" local="false" variableName="term1" />
                          <BinaryOp op="+" style="op-add">
                            <Variable list="false" local="false" variableName="term2" />
                            <Variable list="false" local="false" variableName="term3" />
                          </BinaryOp>
                        </BinaryOp>
                      </VectorOp>
                    </SetVariable>
                    <SetVariable id="3621" style="set-variable">
                      <Variable list="false" local="false" variableName="peg_htarget_ready" />
                      <Constant text="1" />
                    </SetVariable>
                  </Instructions>
                </If>
                <If id="363" style="if">
                  <Comparison op="ge" style="op-gte">
                    <CraftProperty property="Altitude.AGL" style="prop-altitude" />
                    <Constant text="10000" />
                  </Comparison>
                  <Instructions>
                    <SetVariable id="364" style="set-variable">
                      <Variable list="false" local="false" variableName="hvec" />
                      <VectorOp op="cross" style="vec-op-2">
                        <Variable list="false" local="false" variableName="rvec" />
                        <Variable list="false" local="false" variableName="vvec" />
                      </VectorOp>
                    </SetVariable>
                    <SetVariable id="365" style="set-variable">
                      <Variable list="false" local="false" variableName="hhat" />
                      <VectorOp op="norm" style="vec-op-1">
                        <Variable list="false" local="false" variableName="hvec" />
                      </VectorOp>
                    </SetVariable>
                    <SetVariable id="366" style="set-variable">
                      <Variable list="false" local="false" variableName="planeerroraxis" />
                      <VectorOp op="cross" style="vec-op-2">
                        <Variable list="false" local="false" variableName="hhat" />
                        <Variable list="false" local="false" variableName="peg_htarget" />
                      </VectorOp>
                    </SetVariable>
                    <SetVariable id="367" style="set-variable">
                      <Variable list="false" local="false" variableName="planeerrormag" />
                      <VectorOp op="length" style="vec-op-1">
                        <Variable list="false" local="false" variableName="planeerroraxis" />
                      </VectorOp>
                    </SetVariable>
                    <SetVariable id="368" style="set-variable">
                      <Variable list="false" local="false" variableName="ki" />
                      <BinaryOp op="/" style="op-div">
                        <Variable list="false" local="false" variableName="planeerrormag" />
                        <Constant text="5" />
                      </BinaryOp>
                    </SetVariable>
                    <If id="369" style="if">
                      <Comparison op="g" style="op-gt">
                        <Variable list="false" local="false" variableName="ki" />
                        <Variable list="false" local="false" variableName="k_i_max" />
                      </Comparison>
                      <Instructions>
                        <SetVariable id="370" style="set-variable">
                          <Variable list="false" local="false" variableName="ki" />
                          <Variable list="false" local="false" variableName="k_i_max" />
                        </SetVariable>
                      </Instructions>
                    </If>
                  </Instructions>
                </If>
              </Instructions>
            </If>
            <SetVariable id="371" style="set-variable">
              <Variable list="false" local="false" variableName="gvec" />
              <CraftProperty property="Vel.Gravity" style="prop-velocity" />
            </SetVariable>
            <SetVariable id="372" style="set-variable">
              <Variable list="false" local="false" variableName="rmag" />
              <VectorOp op="length" style="vec-op-1">
                <Variable list="false" local="false" variableName="rvec" />
              </VectorOp>
            </SetVariable>
            <SetVariable id="373" style="set-variable">
              <Variable list="false" local="false" variableName="gmag" />
              <VectorOp op="length" style="vec-op-1">
                <Variable list="false" local="false" variableName="gvec" />
              </VectorOp>
            </SetVariable>
            <SetVariable id="374" style="set-variable">
              <Variable list="false" local="false" variableName="mu" />
              <BinaryOp op="*" style="op-mul">
                <Variable list="false" local="false" variableName="gmag" />
                <BinaryOp op="^" style="op-exp">
                  <Variable list="false" local="false" variableName="rmag" />
                  <Constant text="2" />
                </BinaryOp>
              </BinaryOp>
            </SetVariable>
            <SetVariable id="375" style="set-variable">
              <Variable list="false" local="false" variableName="r" />
              <Planet op="radius" style="planet">
                <Constant text="Droo" />
              </Planet>
            </SetVariable>
            <SetVariable id="376" style="set-variable">
              <Variable list="false" local="false" variableName="rt" />
              <BinaryOp op="+" style="op-add">
                <Variable list="false" local="false" variableName="r" />
                <Variable list="false" local="false" variableName="targetalt_m" />
              </BinaryOp>
            </SetVariable>
            <SetVariable id="377" style="set-variable">
              <Variable list="false" local="false" variableName="vcirc" />
              <MathFunction function="sqrt" style="op-math">
                <BinaryOp op="/" style="op-div">
                  <Variable list="false" local="false" variableName="mu" />
                  <Variable list="false" local="false" variableName="rt" />
                </BinaryOp>
              </MathFunction>
            </SetVariable>
            <SetVariable id="378" style="set-variable">
              <Variable list="false" local="false" variableName="et" />
              <BinaryOp op="/" style="op-div">
                <BinaryOp op="*" style="op-mul">
                  <Constant text="-1" />
                  <Variable list="false" local="false" variableName="mu" />
                </BinaryOp>
                <BinaryOp op="*" style="op-mul">
                  <Constant text="2" />
                  <Variable list="false" local="false" variableName="rt" />
                </BinaryOp>
              </BinaryOp>
            </SetVariable>
            <SetVariable id="379" style="set-variable">
              <Variable list="false" local="false" variableName="vmag" />
              <VectorOp op="length" style="vec-op-1">
                <Variable list="false" local="false" variableName="vvec" />
              </VectorOp>
            </SetVariable>
            <SetVariable id="380" style="set-variable">
              <Variable list="false" local="false" variableName="e" />
              <BinaryOp op="-" style="op-sub">
                <BinaryOp op="/" style="op-div">
                  <BinaryOp op="^" style="op-exp">
                    <Variable list="false" local="false" variableName="vmag" />
                    <Constant text="2" />
                  </BinaryOp>
                  <Constant text="2" />
                </BinaryOp>
                <BinaryOp op="/" style="op-div">
                  <Variable list="false" local="false" variableName="mu" />
                  <Variable list="false" local="false" variableName="rmag" />
                </BinaryOp>
              </BinaryOp>
            </SetVariable>
            <SetVariable id="381" style="set-variable">
              <Variable list="false" local="false" variableName="ee" />
              <BinaryOp op="-" style="op-sub">
                <Variable list="false" local="false" variableName="et" />
                <Variable list="false" local="false" variableName="e" />
              </BinaryOp>
            </SetVariable>
            <SetVariable id="382" style="set-variable">
              <Variable list="false" local="false" variableName="ke" />
              <BinaryOp op="/" style="op-div">
                <Variable list="false" local="false" variableName="ee" />
                <Variable list="false" local="false" variableName="escale" />
              </BinaryOp>
            </SetVariable>
            <If id="383" style="if">
              <Comparison op="g" style="op-gt">
                <Constant text="0" />
                <Variable list="false" local="false" variableName="ke" />
              </Comparison>
              <Instructions>
                <SetVariable id="384" style="set-variable">
                  <Variable list="false" local="false" variableName="ke" />
                  <Constant text="0" />
                </SetVariable>
              </Instructions>
            </If>
            <If id="385" style="if">
              <Comparison op="g" style="op-gt">
                <Variable list="false" local="false" variableName="ke" />
                <Variable list="false" local="false" variableName="k_e_max" />
              </Comparison>
              <Instructions>
                <SetVariable id="386" style="set-variable">
                  <Variable list="false" local="false" variableName="ke" />
                  <Variable list="false" local="false" variableName="k_e_max" />
                </SetVariable>
              </Instructions>
            </If>
            <If id="387" style="if">
              <Comparison op="=" style="op-eq">
                <Variable list="false" local="false" variableName="peg_readyk" />
                <Constant text="1" />
              </Comparison>
              <Instructions>
                <SetVariable id="388" style="set-variable">
                  <Variable list="false" local="false" variableName="traw" />
                  <VectorOp op="cross" style="vec-op-2">
                    <Variable list="false" local="false" variableName="peg_htarget" />
                    <Variable list="false" local="false" variableName="rhat" />
                  </VectorOp>
                </SetVariable>
                <If id="389" style="if">
                  <Comparison op="l" style="op-lt">
                    <VectorOp op="length" style="vec-op-1">
                      <Variable list="false" local="false" variableName="traw" />
                    </VectorOp>
                    <Constant text=".001" />
                  </Comparison>
                  <Instructions>
                    <SetVariable id="390" style="set-variable">
                      <Variable list="false" local="false" variableName="that" />
                      <Variable list="false" local="false" variableName="ehat" />
                    </SetVariable>
                  </Instructions>
                </If>
                <ElseIf id="391" style="else">
                  <Constant bool="true" />
                  <Instructions>
                    <SetVariable id="392" style="set-variable">
                      <Variable list="false" local="false" variableName="that" />
                      <VectorOp op="norm" style="vec-op-1">
                        <Variable list="false" local="false" variableName="traw" />
                      </VectorOp>
                    </SetVariable>
                  </Instructions>
                </ElseIf>
              </Instructions>
            </If>
            <ElseIf id="393" style="else">
              <Constant bool="true" />
              <Instructions>
                <SetVariable id="394" style="set-variable">
                  <Variable list="false" local="false" variableName="that" />
                  <Variable list="false" local="false" variableName="ehat" />
                </SetVariable>
              </Instructions>
            </ElseIf>
            <If id="395" style="if">
              <Comparison op="l" style="op-lt">
                <VectorOp op="dot" style="vec-op-2">
                  <Variable list="false" local="false" variableName="that" />
                  <Variable list="false" local="false" variableName="vvec" />
                </VectorOp>
                <Constant text="0" />
              </Comparison>
              <Instructions>
                <SetVariable id="396" style="set-variable">
                  <Variable list="false" local="false" variableName="that" />
                  <BinaryOp op="*" style="op-mul">
                    <Constant text="-1" />
                    <Variable list="false" local="false" variableName="that" />
                  </BinaryOp>
                </SetVariable>
              </Instructions>
            </If>
            <If id="397" style="if">
              <Comparison op="g" style="op-gt">
                <Variable list="false" local="false" variableName="ki" />
                <Constant number="0" />
              </Comparison>
              <Instructions>
                <SetVariable id="398" style="set-variable">
                  <Variable list="false" local="false" variableName="hvec2" />
                  <VectorOp op="cross" style="vec-op-2">
                    <Variable list="false" local="false" variableName="rvec" />
                    <Variable list="false" local="false" variableName="vvec" />
                  </VectorOp>
                </SetVariable>
                <SetVariable id="399" style="set-variable">
                  <Variable list="false" local="false" variableName="hhat2" />
                  <VectorOp op="norm" style="vec-op-1">
                    <Variable list="false" local="false" variableName="hvec2" />
                  </VectorOp>
                </SetVariable>
                <SetVariable id="400" style="set-variable">
                  <Variable list="false" local="false" variableName="caxis" />
                  <VectorOp op="cross" style="vec-op-2">
                    <Variable list="false" local="false" variableName="hhat2" />
                    <Variable list="false" local="false" variableName="peg_htarget" />
                  </VectorOp>
                </SetVariable>
              </Instructions>
            </If>
            <If id="401" style="if">
              <Comparison op="g" style="op-gt">
                <VectorOp op="length" style="vec-op-1">
                  <Variable list="false" local="false" variableName="caxis" />
                </VectorOp>
                <Constant text=".0001" />
              </Comparison>
              <Instructions>
                <SetVariable id="402" style="set-variable">
                  <Variable list="false" local="false" variableName="pdir" />
                  <VectorOp op="norm" style="vec-op-1">
                    <VectorOp op="cross" style="vec-op-2">
                      <Variable list="false" local="false" variableName="caxis" />
                      <Variable list="false" local="false" variableName="rhat" />
                    </VectorOp>
                  </VectorOp>
                </SetVariable>
              </Instructions>
            </If>
            <ElseIf id="403" style="else">
              <Constant bool="true" />
              <Instructions>
                <SetVariable id="404" style="set-variable">
                  <Variable list="false" local="false" variableName="pdir" />
                  <Vector style="vec">
                    <Constant number="0" />
                    <Constant number="0" />
                    <Constant number="0" />
                  </Vector>
                </SetVariable>
              </Instructions>
            </ElseIf>
            <SetVariable id="405" style="set-variable">
              <Variable list="false" local="false" variableName="dcmd" />
              <VectorOp op="norm" style="vec-op-1">
                <BinaryOp op="+" style="op-add">
                  <BinaryOp op="+" style="op-add">
                    <Variable list="false" local="false" variableName="that" />
                    <BinaryOp op="*" style="op-mul">
                      <Variable list="false" local="false" variableName="rhat" />
                      <Variable list="false" local="false" variableName="ke" />
                    </BinaryOp>
                  </BinaryOp>
                  <BinaryOp op="*" style="op-mul">
                    <Variable list="false" local="false" variableName="pdir" />
                    <Variable list="false" local="false" variableName="ki" />
                  </BinaryOp>
                </BinaryOp>
              </VectorOp>
            </SetVariable>
            <SetVariable id="406" style="set-variable">
              <Variable list="false" local="false" variableName="ucomp" />
              <VectorOp op="dot" style="vec-op-2">
                <Variable list="false" local="false" variableName="dcmd" />
                <Variable list="false" local="false" variableName="rhat" />
              </VectorOp>
            </SetVariable>
            <SetVariable id="407" style="set-variable">
              <Variable list="false" local="false" variableName="ncomp" />
              <VectorOp op="dot" style="vec-op-2">
                <Variable list="false" local="false" variableName="dcmd" />
                <Variable list="false" local="false" variableName="nhat" />
              </VectorOp>
            </SetVariable>
            <SetVariable id="408" style="set-variable">
              <Variable list="false" local="false" variableName="ecomp" />
              <VectorOp op="dot" style="vec-op-2">
                <Variable list="false" local="false" variableName="dcmd" />
                <Variable list="false" local="false" variableName="ehat" />
              </VectorOp>
            </SetVariable>
            <SetVariable id="409" style="set-variable">
              <Variable list="false" local="false" variableName="pitchrad" />
              <MathFunction function="asin" style="op-math">
                <Variable list="false" local="false" variableName="ucomp" />
              </MathFunction>
            </SetVariable>
            <SetVariable id="410" style="set-variable">
              <Variable list="false" local="false" variableName="pitchdeg" />
              <MathFunction function="rad2deg" style="op-math">
                <Variable list="false" local="false" variableName="pitchrad" />
              </MathFunction>
            </SetVariable>
            <SetVariable id="411" style="set-variable">
              <Variable list="false" local="false" variableName="headingrad" />
              <BinaryOp op="atan2" style="op-atan-2">
                <Variable list="false" local="false" variableName="ecomp" />
                <Variable list="false" local="false" variableName="ncomp" />
              </BinaryOp>
            </SetVariable>
            <SetVariable id="412" style="set-variable">
              <Variable list="false" local="false" variableName="headingdeg" />
              <MathFunction function="rad2deg" style="op-math">
                <Variable list="false" local="false" variableName="headingrad" />
              </MathFunction>
            </SetVariable>
            <If id="413" style="if">
              <Comparison op="l" style="op-lt">
                <Variable list="false" local="false" variableName="headingdeg" />
                <Constant text="0" />
              </Comparison>
              <Instructions>
                <SetVariable id="414" style="set-variable">
                  <Variable list="false" local="false" variableName="headingdeg" />
                  <BinaryOp op="+" style="op-add">
                    <Variable list="false" local="false" variableName="headingdeg" />
                    <Constant text="360" />
                  </BinaryOp>
                </SetVariable>
              </Instructions>
            </If>
            <SetVariable id="415" style="set-variable">
              <Variable list="false" local="false" variableName="hdgerror" />
              <BinaryOp op="-" style="op-sub">
                <Variable list="false" local="false" variableName="headingdeg" />
                <Variable list="false" local="false" variableName="peg_headingcmd" />
              </BinaryOp>
            </SetVariable>
            <If id="416" style="if">
              <Comparison op="g" style="op-gt">
                <Variable list="false" local="false" variableName="hdgerror" />
                <Constant text="180" />
              </Comparison>
              <Instructions>
                <SetVariable id="417" style="set-variable">
                  <Variable list="false" local="false" variableName="hdgerror" />
                  <BinaryOp op="-" style="op-sub">
                    <Variable list="false" local="false" variableName="hdgerror" />
                    <Constant text="360" />
                  </BinaryOp>
                </SetVariable>
              </Instructions>
            </If>
            <If id="418" style="if">
              <Comparison op="l" style="op-lt">
                <Variable list="false" local="false" variableName="hdgerror" />
                <Constant text="-180" />
              </Comparison>
              <Instructions>
                <SetVariable id="419" style="set-variable">
                  <Variable list="false" local="false" variableName="hdgerror" />
                  <BinaryOp op="+" style="op-add">
                    <Variable list="false" local="false" variableName="hdgerror" />
                    <Constant text="360" />
                  </BinaryOp>
                </SetVariable>
              </Instructions>
            </If>
            <If id="420" style="if">
              <Comparison op="g" style="op-gt">
                <CraftProperty property="Nav.AngleOfAttack" style="prop-nav" />
                <Variable list="false" local="false" variableName="gt_maxaoa" />
              </Comparison>
              <Instructions>
                <SetVariable id="421" style="set-variable">
                  <Variable list="false" local="false" variableName="smoothdiv" />
                  <Constant text="20" />
                </SetVariable>
              </Instructions>
            </If>
            <ElseIf id="422" style="else">
              <Constant bool="true" />
              <Instructions>
                <SetVariable id="423" style="set-variable">
                  <Variable list="false" local="false" variableName="smoothdiv" />
                  <Constant text="10" />
                </SetVariable>
              </Instructions>
            </ElseIf>
            <SetVariable id="424" style="set-variable">
              <Variable list="false" local="false" variableName="peg_pitchcmd" />
              <BinaryOp op="+" style="op-add">
                <Variable list="false" local="false" variableName="peg_pitchcmd" />
                <BinaryOp op="/" style="op-div">
                  <BinaryOp op="-" style="op-sub">
                    <Variable list="false" local="false" variableName="pitchdeg" />
                    <Variable list="false" local="false" variableName="peg_pitchcmd" />
                  </BinaryOp>
                  <Variable list="false" local="false" variableName="smoothdiv" />
                </BinaryOp>
              </BinaryOp>
            </SetVariable>
            <SetVariable id="425" style="set-variable">
              <Variable list="false" local="false" variableName="peg_headingcmd" />
              <BinaryOp op="+" style="op-add">
                <Variable list="false" local="false" variableName="peg_headingcmd" />
                <BinaryOp op="/" style="op-div">
                  <Variable list="false" local="false" variableName="hdgerror" />
                  <Variable list="false" local="false" variableName="smoothdiv" />
                </BinaryOp>
              </BinaryOp>
            </SetVariable>
            <If id="426" style="if">
              <Comparison op="l" style="op-lt">
                <Variable list="false" local="false" variableName="peg_headingcmd" />
                <Constant number="0" />
              </Comparison>
              <Instructions>
                <SetVariable id="427" style="set-variable">
                  <Variable list="false" local="false" variableName="peg_headingcmd" />
                  <BinaryOp op="+" style="op-add">
                    <Variable list="false" local="false" variableName="peg_headingcmd" />
                    <Constant text="360" />
                  </BinaryOp>
                </SetVariable>
              </Instructions>
            </If>
            <If id="428" style="if">
              <Comparison op="ge" style="op-gte">
                <Variable list="false" local="false" variableName="peg_headingcmd" />
                <Constant text="360" />
              </Comparison>
              <Instructions>
                <SetVariable id="429" style="set-variable">
                  <Variable list="false" local="false" variableName="peg_headingcmd" />
                  <BinaryOp op="-" style="op-sub">
                    <Variable list="false" local="false" variableName="peg_headingcmd" />
                    <Constant text="360" />
                  </BinaryOp>
                </SetVariable>
              </Instructions>
            </If>
            <SetTargetHeading property="pitch" id="430" style="set-heading">
              <Variable list="false" local="false" variableName="peg_pitchcmd" />
            </SetTargetHeading>
            <SetTargetHeading property="heading" id="431" style="set-heading">
              <Variable list="false" local="false" variableName="peg_headingcmd" />
            </SetTargetHeading>
            <WaitSeconds id="432" style="wait-seconds">
              <Constant text="0.05" />
            </WaitSeconds>
          </Instructions>
        </While>
      </Instructions>
    </While>
  </Instructions>
  <Instructions>
    <CustomInstruction callFormat="Countdown" format="Countdown" name="Countdown" id="433" style="custom-instruction" pos="4086.381,1256.738" />
    <SetVariable id="434" style="set-variable">
      <Variable list="false" local="false" variableName="gt_tsv" />
      <Constant text="250" />
    </SetVariable>
    <LockNavSphere indicatorType="Current" id="435" style="lock-nav-sphere" />
    <DisplayMessage id="436" style="display">
      <Constant text="Set Throttle&gt;90% to arm countdown (timeout 30s, AG1 abort)." />
      <Constant number="7" />
    </DisplayMessage>
    <SetVariable id="437" style="set-variable">
      <Variable list="false" local="false" variableName="countdown_timeout_s" />
      <Variable list="false" local="false" variableName="countdown_timeout_default_s" />
    </SetVariable>
    <SetVariable id="438" style="set-variable">
      <Variable list="false" local="false" variableName="countdown_elapsed_s" />
      <Constant text="0" />
    </SetVariable>
    <SetVariable id="439" style="set-variable">
      <Variable list="false" local="false" variableName="countdown_abort" />
      <Constant text="0" />
    </SetVariable>
    <While id="440" style="while">
      <Constant style="true" bool="true" />
      <Instructions>
        <If id="441" style="if">
          <Comparison op="g" style="op-gt">
            <CraftProperty property="Input.Throttle" style="prop-input" />
            <Variable list="false" local="false" variableName="countdown_arm_throttle" />
          </Comparison>
          <Instructions>
            <Break id="442" style="break" />
          </Instructions>
        </If>
        <If id="443" style="if">
          <Comparison op="=" style="op-eq">
            <ActivationGroup style="activation-group">
              <Constant number="1" />
            </ActivationGroup>
            <Constant text="1" />
          </Comparison>
          <Instructions>
            <SetVariable id="444" style="set-variable">
              <Variable list="false" local="false" variableName="countdown_abort" />
              <Constant text="1" />
            </SetVariable>
            <SetVariable id="445" style="set-variable">
              <Variable list="false" local="false" variableName="fc_fault_code" />
              <Constant text="101" />
            </SetVariable>
            <Break id="446" style="break" />
          </Instructions>
        </If>
        <If id="447" style="if">
          <Comparison op="ge" style="op-gte">
            <Variable list="false" local="false" variableName="countdown_elapsed_s" />
            <Variable list="false" local="false" variableName="countdown_timeout_s" />
          </Comparison>
          <Instructions>
            <SetVariable id="448" style="set-variable">
              <Variable list="false" local="false" variableName="countdown_abort" />
              <Constant text="1" />
            </SetVariable>
            <SetVariable id="449" style="set-variable">
              <Variable list="false" local="false" variableName="fc_fault_code" />
              <Constant text="100" />
            </SetVariable>
            <Break id="450" style="break" />
          </Instructions>
        </If>
        <WaitSeconds id="451" style="wait-seconds">
          <Variable list="false" local="false" variableName="countdown_tick_s" />
        </WaitSeconds>
        <SetVariable id="452" style="set-variable">
          <Variable list="false" local="false" variableName="countdown_elapsed_s" />
          <BinaryOp op="+" style="op-add">
            <Variable list="false" local="false" variableName="countdown_elapsed_s" />
            <Variable list="false" local="false" variableName="countdown_tick_s" />
          </BinaryOp>
        </SetVariable>
      </Instructions>
    </While>
    <If id="453" style="if">
      <Comparison op="=" style="op-eq">
        <Variable list="false" local="false" variableName="countdown_abort" />
        <Constant text="0" />
      </Comparison>
      <Instructions>
        <SetVariable id="454" style="set-variable">
          <Variable list="false" local="false" variableName="fc_fault_code" />
          <Constant text="0" />
        </SetVariable>
        <SetCraftProperty property="Sound.Beep" id="455" style="play-beep">
          <Constant number="1000" />
          <Constant number="1" />
          <Constant text=".5" />
        </SetCraftProperty>
        <DisplayMessage id="456" style="display">
          <Constant text="3" />
          <Constant number="7" />
        </DisplayMessage>
        <WaitSeconds id="457" style="wait-seconds">
          <Constant number="1" />
        </WaitSeconds>
        <SetCraftProperty property="Sound.Beep" id="458" style="play-beep">
          <Constant number="1000" />
          <Constant number="1" />
          <Constant text=".5" />
        </SetCraftProperty>
        <DisplayMessage id="459" style="display">
          <Constant text="2" />
          <Constant number="7" />
        </DisplayMessage>
        <WaitSeconds id="460" style="wait-seconds">
          <Constant number="1" />
        </WaitSeconds>
        <SetCraftProperty property="Sound.Beep" id="461" style="play-beep">
          <Constant number="1000" />
          <Constant number="1" />
          <Constant text=".5" />
        </SetCraftProperty>
        <DisplayMessage id="462" style="display">
          <Constant text="1" />
          <Constant number="7" />
        </DisplayMessage>
        <WaitSeconds id="463" style="wait-seconds">
          <Constant number="1" />
        </WaitSeconds>
        <SetCraftProperty property="Sound.Beep" id="464" style="play-beep">
          <Constant text="1500" />
          <Constant number="1" />
          <Constant text=".5" />
        </SetCraftProperty>
        <DisplayMessage id="465" style="display">
          <Constant text="Blastoff!!!!" />
          <Constant number="7" />
        </DisplayMessage>
        <ActivateStage id="466" style="activate-stage" />
        <WaitUntil id="467" style="wait-until">
          <Comparison op="g" style="op-gt">
            <CraftProperty property="Vel.SurfaceVelocity" style="prop-velocity" />
            <Variable list="false" local="false" variableName="gt_tsv" />
          </Comparison>
        </WaitUntil>
        <SetVariable id="468" style="set-variable">
          <Variable list="false" local="false" variableName="fc_mode" />
          <Variable list="false" local="false" variableName="fc_mode_ascent" />
        </SetVariable>
        <DisplayMessage id="469" style="display">
          <Constant text="Beginning Gravity Turn" />
          <Constant number="7" />
        </DisplayMessage>
        <LogFlight id="470" style="flightlog">
          <Constant text="Beginning Gravity Turn" />
          <Constant style="false" bool="false" />
        </LogFlight>
      </Instructions>
    </If>
    <ElseIf id="471" style="else">
      <Constant bool="true" />
      <Instructions>
        <SetVariable id="4711" style="set-variable">
          <Variable list="false" local="false" variableName="fc_mode" />
          <Variable list="false" local="false" variableName="fc_mode_none" />
        </SetVariable>
        <SetVariable id="4712" style="set-variable">
          <Variable list="false" local="false" variableName="attowner" />
          <Variable list="false" local="false" variableName="attowner_none" />
        </SetVariable>
        <SetVariable id="4713" style="set-variable">
          <Variable list="false" local="false" variableName="throwner" />
          <Variable list="false" local="false" variableName="throwner_none" />
        </SetVariable>
        <SetVariable id="4714" style="set-variable">
          <Variable list="false" local="false" variableName="fc_status_code" />
          <Constant text="0" />
        </SetVariable>
        <LogFlight id="472" style="flightlog">
          <BinaryOp op="+" style="op-add">
            <Constant text="Countdown fault latched; fc_fault_code=" />
            <Variable list="false" local="false" variableName="fc_fault_code" />
          </BinaryOp>
          <Constant style="false" bool="false" />
        </LogFlight>
      </Instructions>
    </ElseIf>
  </Instructions>
  <Expressions />
</Program>
